"use strict";var Qn=Object.create;var ct=Object.defineProperty;var Jn=Object.getOwnPropertyDescriptor;var ei=Object.getOwnPropertyNames;var ti=Object.getPrototypeOf,oi=Object.prototype.hasOwnProperty;var Vo=(e,t)=>{for(var o in t)ct(e,o,{get:t[o],enumerable:!0})},_o=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ei(t))!oi.call(e,n)&&n!==o&&ct(e,n,{get:()=>t[n],enumerable:!(r=Jn(t,n))||r.enumerable});return e};var u=(e,t,o)=>(o=e!=null?Qn(ti(e)):{},_o(t||!e||!e.__esModule?ct(o,"default",{value:e,enumerable:!0}):o,e)),ri=e=>_o(ct({},"__esModule",{value:!0}),e);var Ji={};Vo(Ji,{ChonkyActions:()=>f,ChonkyDndFileEntryType:()=>ye,ChonkyIconName:()=>j,CustomVisibilityState:()=>ze,DefaultFileActions:()=>qe,FileBrowser:()=>et,FileContextMenu:()=>Ut,FileHelper:()=>F,FileList:()=>st,FileNavbar:()=>Ht,FileToolbar:()=>Kt,FileViewMode:()=>Ce,FullFileBrowser:()=>Go,I18nNamespace:()=>xe,OptionIds:()=>ie,defaultFormatters:()=>Ze,defineFileAction:()=>D,fileMap:()=>Ko,getActionI18nId:()=>ht,getFileData:()=>So,getI18nId:()=>q,getIsFileSelected:()=>Ue,getSelectedFiles:()=>sr,getSelectedFilesForAction:()=>ar,reduxActions:()=>g,rootReducer:()=>xo,selectCleanFileIds:()=>to,selectClearSelectionOnOutsideClick:()=>yo,selectContextMenuConfig:()=>ut,selectContextMenuItems:()=>eo,selectContextMenuMounted:()=>go,selectContextMenuTriggerFile:()=>bo,selectCurrentFolder:()=>ve,selectDisableSelection:()=>ao,selectDoubleClickDelay:()=>fo,selectExternalFileActionHandler:()=>Zt,selectFileActionData:()=>se,selectFileActionIds:()=>Qt,selectFileActionMap:()=>Ve,selectFileData:()=>oo,selectFileMap:()=>Se,selectFileViewConfig:()=>ce,selectFocusSearchInput:()=>no,selectFolderChain:()=>he,selectHiddenFileCount:()=>ro,selectHiddenFileIdMap:()=>pt,selectInstanceId:()=>Ke,selectIsDnDDisabled:()=>je,selectIsFileSelected:()=>lo,selectOptionMap:()=>Yo,selectOptionValue:()=>mo,selectParentFolder:()=>_e,selectRawFiles:()=>ni,selectSearchString:()=>io,selectSelectedFileIds:()=>mt,selectSelectedFiles:()=>$e,selectSelectedFilesForAction:()=>qo,selectSelectedFilesForActionCount:()=>so,selectSelectionMap:()=>ee,selectSelectionSize:()=>We,selectSortActionId:()=>co,selectSortOrder:()=>po,selectThumbnailGenerator:()=>uo,selectToolbarItems:()=>Jt,selectors:()=>$,setChonkyDefaults:()=>kr,thunkDispatchFileAction:()=>Co,thunkRequestFileAction:()=>I,useChonkyStore:()=>Do,useDTE:()=>te,useParamSelector:()=>_,usePropReduxUpdate:()=>Ft});module.exports=ri(Ji);var Et=require("@material-ui/core/styles"),Mt=u(require("deepmerge")),K=u(require("react")),Yr=require("react-dnd"),Xr=require("react-dnd-html5-backend"),Zr=require("react-intl"),Qr=require("react-jss"),Jr=require("react-redux"),en=u(require("shortid"));var Ye=require("react"),Xe=require("react-redux"),xr=require("@reduxjs/toolkit");var ue=require("react"),$o=(e,t)=>{let[o,r]=(0,ue.useState)(e);return(0,ue.useEffect)(()=>{let n=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(n)}},[e,t]),[o,r]},Wo={},dt=e=>{let t=(0,ue.useRef)(Wo);return t.current===Wo&&(t.current=e()),t.current},ne=e=>{let t=(0,ue.useRef)(e);return(0,ue.useEffect)(()=>{t.current=e},[t,e]),t};var Fr=require("@reduxjs/toolkit");var P=class{static error(...t){console.error("[Chonky runtime error]",...t)}static warn(...t){console.warn("[Chonky runtime warning]",...t)}static debug(...t){console.debug("[Chonky runtime debug]",...t)}static formatBullets(t){return`
- ${t.join(`
- `)}`}};var F=class{static isDirectory(t){return!!t&&t.isDir===!0}static isHidden(t){return!!t&&t.isHidden===!0}static isSymlink(t){return!!t&&t.isSymlink===!0}static isEncrypted(t){return!!t&&t.isEncrypted===!0}static isClickable(t){return!!t}static isOpenable(t){return!!t&&t.openable!==!1}static isSelectable(t){return!!t&&t.selectable!==!1}static isDraggable(t){return!!t&&t.draggable!==!1}static isDroppable(t){return t?t.isDir&&t.droppable!==!1?!0:t.droppable===!0:!1}static isDndOpenable(t){return F.isOpenable(t)?t.isDir&&t.dndOpenable!==!1?!0:t.dndOpenable===!0:!1}static getModDate(t){return!t||t.modDate===null||t.modDate===void 0?null:F.parseDate(t.modDate)}static parseDate(t){if(typeof t=="string"||typeof t=="number")try{return new Date(t)}catch(o){P.error(`Could not convert provided string/number into a date: ${o.message} `,"Invalid value:",t)}return t instanceof Date&&!isNaN(t.getTime())?t:(P.warn("Unsupported date representation:",t),null)}static getChildrenCount(t){return!t||typeof t.childrenCount!="number"?null:t.childrenCount}};var Ge=(e,t)=>{let o=[],r=[];if(!((e==="folderChain"||e==="fileActions")&&!t))if(!Array.isArray(t))r.push(`Expected "${e}" prop to be an array, got "${typeof t}" instead.`);else{let n=0,i=0,l=new Set,s=new Set;for(let a=0;a<t.length;++a){let c=t[a];c?typeof c!="object"?n++:!c.id||e!=="fileActions"&&!c.name?i++:l.has(c.id)?s.add(c.id):(l.add(c.id),o.push(c)):e==="fileActions"?n++:o.push(null)}if(n&&r.push(`Detected ${n} file(s) of invalid type. Remember that "files" array should contain either objects or nulls.`),i&&r.push(`Detected ${i} file(s) that are missing the required fields. Remember that file object should define an "id" and a "name".`),s.size>0){let a='"'+Array.from(s).join('", "')+'"';r.push(`Detected ${s.size} file IDs that are used multiple times. Remember that each file should have a unique IDs. The following IDs were seen multiple times: ${a}`)}}if(r.length>0){let n=`
- `+r.join(`
- `),i,l;e==="folderChain"?(i="folder chain",l="files"):e==="fileActions"?(i="file actions",l="file actions"):(i="files",l="files"),P.error(`Errors were detected when sanitizing the ${i} array. Offending ${l} were removed from the array. Summary of validation errors: ${n}`)}return{sanitizedArray:o,errorMessages:r}};var jo=u(require("fast-sort")),Uo=u(require("fuzzy-search")),le=require("@reduxjs/toolkit");var ie={ShowHiddenFiles:"show_hidden_files",ShowFoldersFirst:"show_folders_first",DarkMode:"dark_mode"};var Ke=e=>e.instanceId,Zt=e=>e.externalFileActionHandler,Ve=e=>e.fileActionMap,Qt=e=>e.fileActionIds,se=e=>t=>Ve(t)[e],Jt=e=>e.toolbarItems,eo=e=>e.contextMenuItems,he=e=>e.folderChain,ve=e=>{let t=he(e);return t.length>0?t[t.length-1]:null},_e=e=>{let t=he(e);return t.length>1?t[t.length-2]:null},ni=e=>e.rawFiles,Se=e=>e.fileMap,to=e=>e.cleanFileIds,oo=e=>t=>e?Se(t)[e]:null,pt=e=>e.hiddenFileIdMap,ro=e=>Object.keys(pt(e)).length,no=e=>e.focusSearchInput,io=e=>e.searchString,ee=e=>e.selectionMap,mt=e=>Object.keys(ee(e)),We=e=>mt(e).length,lo=e=>t=>!!e&&!!ee(t)[e],$e=e=>{let t=Se(e);return Object.keys(ee(e)).map(o=>t[o])},qo=e=>t=>{let{fileActionMap:o}=t,r=o[e];if(!(!r||!r.requiresSelection))return sr(t,r.fileFilter)},so=e=>t=>{var o;return(o=ar(t,e))==null?void 0:o.length},ao=e=>e.disableSelection,ce=e=>e.fileViewConfig,co=e=>e.sortActionId,po=e=>e.sortOrder,Yo=e=>e.optionMap,mo=e=>t=>Yo(t)[e],uo=e=>e.thumbnailGenerator,fo=e=>e.doubleClickDelay,je=e=>e.disableDragAndDrop,yo=e=>e.clearSelectionOnOutsideClick,go=e=>e.contextMenuMounted,ut=e=>e.contextMenuConfig,bo=e=>{let t=ut(e);return!t||!t.triggerFileId?null:Se(e)[t.triggerFileId]??null},Xo=e=>e.fileActionMap,Zo=e=>e.optionMap,Qo=e=>e.fileMap,Yt=e=>e.fileIds,ft=e=>e.cleanFileIds,Jo=e=>e.sortActionId,er=e=>e.sortOrder,tr=e=>e.searchString,or=e=>e.lastClick,rr=e=>(0,le.createSelector)([Xo,e],(t,o)=>o&&t[o]?t[o]:null),Fo=(e,t=void 0)=>(0,le.createSelector)([Zo],o=>{let r=o[e];return r===void 0?t:r}),yt=e=>(0,le.createSelector)([Qo,e],(t,o)=>o.map(r=>r&&t[r]?t[r]:null)),ho=(0,le.createSelector)([Yt,er,yt(Yt),rr(Jo),Fo(ie.ShowFoldersFirst,!1)],(e,t,o,r,n)=>{if(!r)return e;let i=a=>c=>a(c),l=[];if(n&&l.push({desc:i(F.isDirectory)}),r.sortKeySelector){let a=t==="asc"?"asc":"desc";l.push({[a]:i(r.sortKeySelector)})}return l.length===0?e:(0,jo.default)([...o]).by(l).map(a=>a?a.id:null)}),nr=(0,le.createSelector)([yt(ft)],e=>new Uo.default(e,["name"],{caseSensitive:!1})),ir=(0,le.createSelector)([ft,tr,nr],(e,t,o)=>t?o.search(t).map(r=>r.id):e),lr=(0,le.createSelector)([ir,yt(ft),Fo(ie.ShowHiddenFiles)],(e,t,o)=>{let r=new Set(e),n={};return t.forEach(i=>{if(i)r.has(i.id)?!o&&F.isHidden(i)&&(n[i.id]=!0):n[i.id]=!0;else return}),n}),ii=(0,le.createSelector)([ho,lr],(e,t)=>e.filter(o=>!o||!t[o])),li=(0,le.createSelector)([or,ho],(e,t)=>!e||e.index>t.length-1||e.fileId!=t[e.index]?null:e.index),$={getFileActionMap:Xo,getOptionMap:Zo,getFileMap:Qo,getFileIds:Yt,getCleanFileIds:ft,getSortActionId:Jo,getSortOrder:er,getSearchString:tr,_getLastClick:or,getSortedFileIds:ho,getSearcher:nr,getSearchFilteredFileIds:ir,getHiddenFileIdMap:lr,getDisplayFileIds:ii,getLastClickIndex:li,makeGetAction:rr,makeGetOptionValue:Fo,makeGetFiles:yt},So=(e,t)=>t?Se(e)[t]:null,Ue=(e,t)=>!!ee(e)[t.id],sr=(e,...t)=>{let{fileMap:o,selectionMap:r}=e,n=Object.keys(r).map(l=>o[l]);return t.reduce((l,s)=>s?l.filter(s):l,n)},ar=(e,t)=>qo(t)(e);var si=(...e)=>{let t=new Set,o=i=>!!t.add(i.id),r=i=>!t.has(i.id),n=e.map(i=>{let l=i.filter(r);return l.map(o),l});return new Array().concat(...n)},cr=(e,t)=>o=>{let{sanitizedArray:r,errorMessages:n}=Ge("fileActions",e),i;if(Array.isArray(t)){let a=new Set(t);i=qe.filter(c=>!a.has(c.id))}else t?i=[]:i=qe;let l=si(r,mr,i),s={};l.map(a=>a.option?s[a.option.id]=a.option.defaultValue:null),o(g.setRawFileActions(e)),o(g.setFileActionsErrorMessages(n)),o(g.setFileActions(l)),o(g.setOptionDefaults(s)),o(ai(l))},ai=e=>t=>{let o=new Set([f.OpenParentFolder.id]),r=[],n={},i=[],l={},s=(a,c,d)=>{if(c[d])return c[d];let p={name:d,fileActionIds:[]};return a.push(p),c[d]=p,p};for(let a of e){let c=a.button;!c||(c.toolbar&&!o.has(a.id)&&(c.group?s(r,n,c.group).fileActionIds.push(a.id):r.push(a.id)),c.contextMenu&&(c.group?s(i,l,c.group).fileActionIds.push(a.id):i.push(a.id)))}t(g.updateFileActionMenuItems([r,i]))},dr=e=>(t,o)=>{let{fileActionMap:r}=o(),n=e?r[e]:null;n&&n.fileViewConfig&&t(g.setFileViewConfig(n.fileViewConfig))},gt=e=>(t,o)=>{if(!e)return;let{sortActionId:r,sortOrder:n,fileActionMap:i}=o(),l=i[e];if(!l||!l.sortKeySelector)return;let s=n==="desc"?"desc":"asc";r!==e&&(s="asc"),t(g.setSort({actionId:e,order:s}))},pr=e=>(t,o)=>{let r=e.selectionTransform;if(!r)return;let n=o(),i=new Set(Object.keys(ee(n))),l=new Set(Object.keys(pt(n))),s=r({prevSelection:i,fileIds:to(n),fileMap:Se(n),hiddenFileIds:l});!s||(s.size===0?t(g.clearSelection()):t(g.selectFiles({fileIds:Array.from(s),reset:!0})))};var Co=e=>(t,o)=>{P.debug(`FILE ACTION DISPATCH: [${e.id}]`,"data:",e);let r=o(),n=Ve(r)[e.id],i=Zt(r);n?i&&Promise.resolve(i(e)).catch(l=>P.error(`User-defined file action handler threw an error: ${l.message}`)):P.warn(`Internal components dispatched the "${e.id}" file action, but such action was not registered.`)},I=(e,t)=>(o,r)=>{P.debug(`FILE ACTION REQUEST: [${e.id}]`,"action:",e,"payload:",t);let n=r(),i=Ke(n);Ve(n)[e.id]||P.warn(`The action "${e.id}" was requested, but it is not registered. The action will still be dispatched, but this might indicate a bug in the code. Please register your actions by passing them to "fileActions" prop.`);let l=$e(n),s=e.fileFilter?l.filter(e.fileFilter):l;if(e.requiresSelection&&s.length===0){P.warn(`Internal components requested the "${e.id}" file action, but the selection for this action was empty. This might a bug in the code of the presentational components.`);return}let a=bo(n),c={instanceId:i,selectedFiles:l,selectedFilesForAction:s,contextMenuTriggerFile:a};e.sortKeySelector&&o(gt(e.id));let p=e.fileViewConfig;p&&o(g.setFileViewConfig(p));let b=e.option;b&&o(g.toggleOption(b.id)),e.selectionTransform&&o(pr(e));let C=e.effect,S;if(C)try{S=C({action:e,payload:t,state:c,reduxDispatch:o,getReduxState:r})}catch(w){P.error(`User-defined effect function for action ${e.id} threw an error: ${w.message}`)}return Promise.resolve(S).then(w=>{let N={id:e.id,action:e,payload:t,state:c};ur(o,N,w)}).catch(w=>{P.error(`User-defined effect function for action ${e.id} returned a promise that was rejected: ${w.message}`);let N={id:e.id,action:e,payload:t,state:c};ur(o,N,void 0)})},ur=(e,t,o)=>{o===!0||e(Co(t))};var Ce=(r=>(r.List="list",r.Compact="compact",r.Grid="grid",r))(Ce||{});var j=(m=>(m.loading="loading",m.dropdown="dropdown",m.placeholder="placeholder",m.dndDragging="dndDragging",m.dndCanDrop="dndCanDrop",m.dndCannotDrop="dndCannotDrop",m.openFiles="openFiles",m.openParentFolder="openParentFolder",m.copy="copy",m.paste="paste",m.share="share",m.search="search",m.selectAllFiles="selectAllFiles",m.clearSelection="clearSelection",m.sortAsc="sortAsc",m.sortDesc="sortDesc",m.toggleOn="toggleOn",m.toggleOff="toggleOff",m.list="list",m.compact="compact",m.smallThumbnail="smallThumbnail",m.largeThumbnail="largeThumbnail",m.folder="folder",m.folderCreate="folderCreate",m.folderOpen="folderOpen",m.folderChainSeparator="folderChainSeparator",m.download="download",m.upload="upload",m.trash="trash",m.fallbackIcon="fallbackIcon",m.symlink="symlink",m.hidden="hidden",m.file="file",m.license="license",m.code="code",m.config="config",m.model="model",m.database="database",m.text="text",m.archive="archive",m.image="image",m.video="video",m.info="info",m.key="key",m.lock="lock",m.music="music",m.terminal="terminal",m.users="users",m.linux="linux",m.ubuntu="ubuntu",m.windows="windows",m.rust="rust",m.python="python",m.nodejs="nodejs",m.php="php",m.git="git",m.adobe="adobe",m.pdf="pdf",m.excel="excel",m.word="word",m.flash="flash",m))(j||{});var D=(e,t)=>{if(e.__payloadType!==void 0&&(e.hotkeys||e.button)){let o=`Invalid definition was provided for file action "${e.id}". Actions that specify hotkeys or buttons cannot define a payload type. If your application requires this functionality, define two actions and chain them using effects.`;throw P.error(o),new Error(o)}return e.effect=t,e},bt=(e,t)=>!e||t(e)?e:e.parentElement?bt(e.parentElement,t):null,fr=e=>!!bt(e,t=>t.tagName&&t.tagName.toLowerCase()==="button"),G=(e,t,o)=>o?typeof e===o?e:t:e!==void 0?e:t;var yr={selectRange:e=>(t,o)=>{let r=o();if(r.disableSelection)return;let i=$.getDisplayFileIds(r).slice(e.rangeStart,e.rangeEnd+1).filter(l=>l&&F.isSelectable(r.fileMap[l]));t(g.selectFiles({fileIds:i,reset:!!e.reset}))}};var we={MouseClickFile:D({id:"mouse_click_file",__payloadType:{}},({payload:e,reduxDispatch:t,getReduxState:o})=>{if(e.clickType==="double")F.isOpenable(e.file)&&t(I(f.OpenFiles,{targetFile:e.file,files:[e.file]}));else{let r=ao(o());if(F.isSelectable(e.file)&&!r)if(e.ctrlKey)t(g.toggleSelection({fileId:e.file.id,exclusive:!1})),t(g.setLastClickIndex({index:e.fileDisplayIndex,fileId:e.file.id}));else if(e.shiftKey){let n=$.getLastClickIndex(o());if(typeof n=="number"){let i=n,l=e.fileDisplayIndex;i>l&&([i,l]=[l,i]),t(yr.selectRange({rangeStart:i,rangeEnd:l}))}else t(g.toggleSelection({fileId:e.file.id,exclusive:!1})),t(g.setLastClickIndex({index:e.fileDisplayIndex,fileId:e.file.id}))}else t(g.toggleSelection({fileId:e.file.id,exclusive:!0})),t(g.setLastClickIndex({index:e.fileDisplayIndex,fileId:e.file.id}));else!e.ctrlKey&&!r&&t(g.clearSelection()),t(g.setLastClickIndex({index:e.fileDisplayIndex,fileId:e.file.id}))}}),KeyboardClickFile:D({id:"keyboard_click_file",__payloadType:{}},({payload:e,reduxDispatch:t,getReduxState:o})=>{t(g.setLastClickIndex({index:e.fileDisplayIndex,fileId:e.file.id})),e.enterKey?We(o())===0&&t(I(f.OpenFiles,{targetFile:e.file,files:[e.file]})):e.spaceKey&&F.isSelectable(e.file)&&t(g.toggleSelection({fileId:e.file.id,exclusive:e.ctrlKey}))}),StartDragNDrop:D({id:"start_drag_n_drop",__payloadType:{}},({payload:e,reduxDispatch:t,getReduxState:o})=>{let r=e.draggedFile;Ue(o(),r)||F.isSelectable(r)&&t(g.selectFiles({fileIds:[r.id],reset:!0}))}),EndDragNDrop:D({id:"end_drag_n_drop",__payloadType:{}},({payload:e,reduxDispatch:t,getReduxState:o})=>{if(Ue(o(),e.destination))return;let{draggedFile:r,selectedFiles:n}=e,i=n.length>0?n:[r];t(I(f.MoveFiles,{...e,files:i}))}),MoveFiles:D({id:"move_files",__payloadType:{}}),ChangeSelection:D({id:"change_selection",__payloadType:{}}),OpenFiles:D({id:"open_files",__payloadType:{}}),OpenParentFolder:D({id:"open_parent_folder",hotkeys:["backspace"],button:{name:"Go up a directory",toolbar:!0,contextMenu:!1,icon:"openParentFolder",iconOnly:!0}},({reduxDispatch:e,getReduxState:t})=>{let o=_e(t());F.isOpenable(o)?e(I(f.OpenFiles,{targetFile:o,files:[o]})):P.warn("Open parent folder effect was triggered  even though the parent folder is not openable. This indicates a bug in presentation components.")}),OpenFileContextMenu:D({id:"open_file_context_menu",__payloadType:{}},({payload:e,reduxDispatch:t,getReduxState:o})=>{let r=So(o(),e.triggerFileId);r&&(Ue(o(),r)||(F.isSelectable(r)?t(g.selectFiles({fileIds:[e.triggerFileId],reset:!0})):t(g.clearSelection()))),t(g.showContextMenu({triggerFileId:e.triggerFileId,mouseX:e.clientX-2,mouseY:e.clientY-4}))})};var gr={OpenSelection:D({id:"open_selection",hotkeys:["enter"],requiresSelection:!0,fileFilter:F.isOpenable,button:{name:"Open selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:"openFiles"}},({state:e,reduxDispatch:t})=>{t(I(we.OpenFiles,{files:e.selectedFilesForAction}))}),SelectAllFiles:D({id:"select_all_files",hotkeys:["ctrl+a"],button:{name:"Select all files",toolbar:!0,contextMenu:!0,group:"Actions",icon:"selectAllFiles"},selectionTransform:({fileIds:e,hiddenFileIds:t})=>{let o=new Set;return e.map(r=>{t.has(r)||o.add(r)}),o}}),ClearSelection:D({id:"clear_selection",hotkeys:["escape"],button:{name:"Clear selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:"clearSelection"},selectionTransform:({prevSelection:e})=>e.size===0?null:new Set}),EnableListView:D({id:"enable_list_view",fileViewConfig:{mode:"list",entryHeight:30},button:{name:"Switch to List view",toolbar:!0,icon:"list",iconOnly:!0}}),EnableCompactView:D({id:"enable_compact_view",fileViewConfig:{mode:"compact",entryHeight:40,entryWidth:220},button:{name:"Switch to Compact view",toolbar:!0,icon:"compact",iconOnly:!0}}),EnableGridView:D({id:"enable_grid_view",fileViewConfig:{mode:"grid",entryWidth:165,entryHeight:130},button:{name:"Switch to Grid view",toolbar:!0,icon:"smallThumbnail",iconOnly:!0}}),SortFilesByName:D({id:"sort_files_by_name",sortKeySelector:e=>e?e.name.toLowerCase():void 0,button:{name:"Sort by name",toolbar:!0,group:"Options"}}),SortFilesBySize:D({id:"sort_files_by_size",sortKeySelector:e=>e?e.size:void 0,button:{name:"Sort by size",toolbar:!0,group:"Options"}}),SortFilesByDate:D({id:"sort_files_by_date",sortKeySelector:e=>e?e.modDate:void 0,button:{name:"Sort by date",toolbar:!0,group:"Options"}}),ToggleHiddenFiles:D({id:"toggle_hidden_files",hotkeys:["ctrl+h"],option:{id:ie.ShowHiddenFiles,defaultValue:!0},button:{name:"Show hidden files",toolbar:!0,group:"Options"}}),ToggleShowFoldersFirst:D({id:"toggle_show_folders_first",option:{id:ie.ShowFoldersFirst,defaultValue:!0},button:{name:"Show folders first",toolbar:!0,group:"Options"}}),FocusSearchInput:D({id:"focus_search_input",hotkeys:["ctrl+f"]},({getReduxState:e})=>{let t=no(e());t&&t()}),ToggleDarkMode:D({id:"enable_dark_mode",option:{id:ie.DarkMode,defaultValue:!1},button:{name:"Enable dark mode",toolbar:!0,icon:"list",iconOnly:!0}})};var br={CopyFiles:D({id:"copy_files",requiresSelection:!0,hotkeys:["ctrl+c"],button:{name:"Copy selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:"copy"}}),CreateFolder:D({id:"create_folder",button:{name:"Create folder",toolbar:!0,tooltip:"Create a folder",icon:"folderCreate"}}),UploadFiles:D({id:"upload_files",button:{name:"Upload files",toolbar:!0,tooltip:"Upload files",icon:"upload"}}),DownloadFiles:D({id:"download_files",requiresSelection:!0,button:{name:"Download files",toolbar:!0,contextMenu:!0,group:"Actions",icon:"download"}}),DeleteFiles:D({id:"delete_files",requiresSelection:!0,hotkeys:["delete"],button:{name:"Delete files",toolbar:!0,contextMenu:!0,group:"Actions",icon:"trash"}})};var f={...we,...gr,...br},mr=[f.MouseClickFile,f.KeyboardClickFile,f.StartDragNDrop,f.EndDragNDrop,f.MoveFiles,f.ChangeSelection,f.OpenFiles,f.OpenParentFolder,f.OpenFileContextMenu],qe=[f.OpenSelection,f.SelectAllFiles,f.ClearSelection,f.EnableListView,f.EnableGridView,f.SortFilesByName,f.SortFilesBySize,f.SortFilesByDate,f.ToggleHiddenFiles,f.ToggleShowFoldersFirst,f.FocusSearchInput];var Me={instanceId:"CHONKY_INVALID_ID",externalFileActionHandler:null,rawFileActions:[],fileActionsErrorMessages:[],fileActionMap:{},fileActionIds:[],toolbarItems:[],contextMenuItems:[],rawFolderChain:null,folderChainErrorMessages:[],folderChain:[],rawFiles:[],filesErrorMessages:[],fileMap:{},fileIds:[],cleanFileIds:[],sortedFileIds:[],hiddenFileIdMap:{},focusSearchInput:null,searchString:"",searchMode:"currentFolder",selectionMap:{},disableSelection:!1,fileViewConfig:f.EnableGridView.fileViewConfig,sortActionId:null,sortOrder:"asc",optionMap:{},thumbnailGenerator:null,doubleClickDelay:300,disableDragAndDrop:!1,clearSelectionOnOutsideClick:!0,lastClick:null,contextMenuMounted:!1,contextMenuConfig:null};var ci={setExternalFileActionHandler(e,t){e.externalFileActionHandler=t.payload??null},setRawFileActions(e,t){e.rawFileActions=t.payload},setFileActionsErrorMessages(e,t){e.fileActionsErrorMessages=t.payload},setFileActions(e,t){let o={};t.payload.map(n=>o[n.id]=n);let r=t.payload.map(n=>n.id);e.fileActionMap=o,e.fileActionIds=r},updateFileActionMenuItems(e,t){[e.toolbarItems,e.contextMenuItems]=t.payload},setRawFolderChain(e,t){let o=t.payload,{sanitizedArray:r,errorMessages:n}=Ge("folderChain",o);e.rawFolderChain=o,e.folderChain=r,e.folderChainErrorMessages=n},setRawFiles(e,t){let o=t.payload,{sanitizedArray:r,errorMessages:n}=Ge("files",o);e.rawFiles=o,e.filesErrorMessages=n;let i={};r.forEach(a=>{a&&(i[a.id]=a)});let l=r.map(a=>a?a.id:null),s=l.filter(a=>!!a);e.fileMap=i,e.fileIds=l,e.cleanFileIds=s;for(let a of Object.keys(e.selectionMap))i[a]||delete e.selectionMap[a]},setSortedFileIds(e,t){e.sortedFileIds=t.payload},setHiddenFileIds(e,t){e.hiddenFileIdMap=t.payload;for(let o of Object.keys(e.selectionMap))e.hiddenFileIdMap[o]&&delete e.selectionMap[o]},setFocusSearchInput(e,t){e.focusSearchInput=t.payload},setSearchString(e,t){e.searchString=t.payload},selectAllFiles(e){e.fileIds.filter(t=>t&&F.isSelectable(e.fileMap[t])).map(t=>t?e.selectionMap[t]=!0:null)},selectFiles(e,t){e.disableSelection||(t.payload.reset&&(e.selectionMap={}),t.payload.fileIds.filter(o=>o&&F.isSelectable(e.fileMap[o])).map(o=>e.selectionMap[o]=!0))},toggleSelection(e,t){if(e.disableSelection)return;let o=!!e.selectionMap[t.payload.fileId];t.payload.exclusive&&(e.selectionMap={}),o?delete e.selectionMap[t.payload.fileId]:F.isSelectable(e.fileMap[t.payload.fileId])&&(e.selectionMap[t.payload.fileId]=!0)},clearSelection(e){e.disableSelection||Object.keys(e.selectionMap).length!==0&&(e.selectionMap={})},setSelectionDisabled(e,t){e.disableSelection=t.payload,Object.keys(e.selectionMap).length!==0&&(e.selectionMap={})},setFileViewConfig(e,t){e.fileViewConfig=t.payload},setSort(e,t){e.sortActionId=t.payload.actionId,e.sortOrder=t.payload.order},setOptionDefaults(e,t){for(let o of Object.keys(t.payload))o in e.optionMap||(e.optionMap[o]=t.payload[o])},toggleOption(e,t){e.optionMap[t.payload]=!e.optionMap[t.payload]},setThumbnailGenerator(e,t){e.thumbnailGenerator=t.payload},setDoubleClickDelay(e,t){e.doubleClickDelay=t.payload},setDisableDragAndDrop(e,t){e.disableDragAndDrop=t.payload},setClearSelectionOnOutsideClick(e,t){e.clearSelectionOnOutsideClick=t.payload},setLastClickIndex(e,t){e.lastClick=t.payload},setContextMenuMounted(e,t){e.contextMenuMounted=t.payload},showContextMenu(e,t){e.contextMenuConfig=t.payload},hideContextMenu(e){!e.contextMenuConfig||(e.contextMenuConfig=null)}},{actions:g,reducer:xo}=(0,Fr.createSlice)({name:"root",initialState:Me,reducers:ci});var hr=require("react"),Sr=u(require("redux-watch"));var Cr=e=>{(0,hr.useEffect)(()=>{let t=(0,Sr.default)(()=>ee(e.getState())),o=(n,i)=>{if(n===i)return;let l=mt(e.getState()),s=new Set(l);e.dispatch(I(f.ChangeSelection,{selection:s}))},r=[e.subscribe(t(o))];return()=>{for(let n of r)n()}},[e])};var Do=e=>{let t=dt(()=>{let o={...Me,instanceId:e};return(0,xr.configureStore)({preloadedState:o,reducer:xo,middleware:r=>r({serializableCheck:!1}),devTools:{name:`chonky_${e}`}})});return Cr(t),t},_=(e,...t)=>{let o=(0,Ye.useCallback)(r=>e(...t)(r),[e,...t]);return(0,Xe.useSelector)(o)},te=(e,...t)=>{let o=(0,Xe.useDispatch)();(0,Ye.useEffect)(()=>{o(e(...t))},[o,e,...t])},Ft=(e,t)=>{let o=(0,Xe.useDispatch)();(0,Ye.useEffect)(()=>{o(e(t))},[o,e,t])};var Dr=u(require("react"));var Ee=()=>Dr.default.createElement("span",{title:"No icon component found. Please follow Chonky installation instructions to provide a pre-made icon component (or a custom icon)."},"\u26A0\uFE0F");var L={fileActions:null,onFileAction:null,thumbnailGenerator:null,doubleClickDelay:300,disableSelection:!1,disableDefaultFileActions:!1,disableDragAndDrop:!1,disableDragAndDropProvider:!1,defaultSortActionId:f.SortFilesByDate.id,defaultFileViewActionId:f.EnableGridView.id,clearSelectionOnOutsideClick:!0,iconComponent:Ee,darkMode:!1,i18n:{}},kr=e=>{for(let t of Object.keys(L))t in e&&(L[t]=e[t])};var Ir=u(require("filesize")),fe=require("react"),St=require("react-intl");var xe=(l=>(l.Toolbar="toolbar",l.FileList="fileList",l.FileEntry="fileEntry",l.FileContextMenu="contextMenu",l.FileActions="actions",l.FileActionGroups="actionGroups",l))(xe||{}),q=(e,t)=>`chonky.${e}.${t}`,ht=(e,t)=>`chonky.${"actions"}.${e}.${t}`,Ar=e=>{let t=(0,St.useIntl)();return(0,fe.useMemo)(()=>t.formatMessage({id:q("actionGroups",e),defaultMessage:e}),[e,t])},Ct=e=>{let t=(0,St.useIntl)();return(0,fe.useMemo)(()=>{var n,i,l;if(!e)return{buttonName:"",buttonTooltip:void 0};let o=t.formatMessage({id:ht(e.id,"button.name"),defaultMessage:(n=e.button)==null?void 0:n.name}),r;return(i=e.button)!=null&&i.tooltip&&(r=t.formatMessage({id:ht(e.id,"button.tooltip"),defaultMessage:(l=e.button)==null?void 0:l.tooltip})),{buttonName:o,buttonTooltip:r}},[e,t])},xt=e=>{let t=(0,St.useIntl)(),o=(0,fe.useContext)(ko);return(0,fe.useMemo)(()=>({fileModDateString:o.formatFileModDate(t,e),fileSizeString:o.formatFileSize(t,e)}),[e,o,t])},Ze={formatFileModDate:(e,t)=>{let o=F.getModDate(t);return o?e.formatDate(o,{dateStyle:"medium"}):null},formatFileSize:(e,t)=>{if(!t||typeof t.size!="number")return null;let o=t.size,r=(0,Ir.default)(o,{bits:!1,output:"object"});return r.symbol==="B"?`${Math.round(r.value/10)/100} KB`:r.symbol==="KB"?`${Math.round(r.value)} ${r.symbol}`:`${r.value} ${r.symbol}`}},ko=(0,fe.createContext)(Ze);var Dt=require("react"),vr=u(require("exact-trie"));var M=(0,Dt.createContext)(Ee),di=["3g2","3gp","3gpp","asf","asx","avi","dvb","f4v","fli","flv","fvt","h261","h263","h264","jpgm","jpgv","jpm","m1v","m2v","m4u","m4v","mj2","mjp2","mk3d","mks","mkv","mng","mov","movie","mp4","mp4v","mpe","mpeg","mpg","mpg4","mxu","ogv","pyv","qt","smv","ts","uvh","uvm","uvp","uvs","uvu","uvv","uvvh","uvvm","uvvp","uvvs","uvvu","uvvv","viv","vob","webm","wm","wmv","wmx","wvx"],pi=["3ds","apng","azv","bmp","bmp","btif","cgm","cmx","djv","djvu","drle","dwg","dxf","emf","exr","fbs","fh","fh4","fh5","fh7","fhc","fits","fpx","fst","g3","gif","heic","heics","heif","heifs","ico","ico","ief","jls","jng","jp2","jpe","jpeg","jpf","jpg","jpg2","jpm","jpx","jxr","ktx","mdi","mmr","npx","pbm","pct","pcx","pcx","pgm","pic","png","pnm","ppm","psd","pti","ras","rgb","rlc","sgi","sid","sub","svg","svgz","t38","tap","tfx","tga","tif","tiff","uvg","uvi","uvvg","uvvi","vtf","wbmp","wdp","webp","wmf","xbm","xif","xpm","xwd"],mi=["3gpp","aac","adp","aif","aifc","aiff","au","caf","dra","dts","dtshd","ecelp4800","ecelp7470","ecelp9600","eol","flac","kar","lvp","m2a","m3a","m3u","m4a","m4a","mid","midi","mka","mp2","mp2a","mp3","mp3","mp4a","mpga","oga","ogg","pya","ra","ra","ram","rip","rmi","rmp","s3m","sil","snd","spx","uva","uvva","wav","wav","wav","wax","weba","wma","xm"],Io=["#bbbbbb","#d65c5c","#d6665c","#d6705c","#d67a5c","#d6855c","#d68f5c","#d6995c","#d6a35c","#d6ad5c","#d6b85c","#d6c25c","#d6cc5c","#d6d65c","#ccd65c","#c2d65c","#b8d65c","#add65c","#a3d65c","#99d65c","#8fd65c","#85d65c","#7ad65c","#70d65c","#66d65c","#5cd65c","#5cd666","#5cd670","#5cd67a","#5cd685","#5cd68f","#5cd699","#5cd6a3","#5cd6ad","#5cd6b8","#5cd6c2","#5cd6cc","#5cd6d6","#5cccd6","#5cc2d6","#5cb8d6","#5cadd6","#5ca3d6","#5c99d6","#5c8fd6","#5c85d6","#5c7ad6","#5c70d6","#5c66d6","#5c5cd6","#665cd6","#705cd6","#7a5cd6","#855cd6","#8f5cd6","#995cd6","#a35cd6","#ad5cd6","#b85cd6","#c25cd6","#cc5cd6","#d65cd6","#d65ccc","#d65cc2","#d65cb8","#d65cad","#d65ca3","#d65c99","#d65c8f","#d65c85","#d65c7a","#d65c70","#d65c66"],wr=["#777","#8f3d3d","#8f443d","#8f4b3d","#8f523d","#8f583d","#8f5f3d","#8f663d","#8f6d3d","#8f743d","#8f7a3d","#8f813d","#8f883d","#8f8f3d","#888f3d","#818f3d","#7a8f3d","#748f3d","#6d8f3d","#668f3d","#5f8f3d","#588f3d","#528f3d","#4b8f3d","#448f3d","#3d8f3d","#3d8f44","#3d8f4b","#3d8f52","#3d8f58","#3d8f5f","#3d8f66","#3d8f6d","#3d8f74","#3d8f7a","#3d8f81","#3d8f88","#3d8f8f","#3d888f","#3d818f","#3d7a8f","#3d748f","#3d6d8f","#3d668f","#3d5f8f","#3d588f","#3d528f","#3d4b8f","#3d448f","#3d3d8f","#443d8f","#4b3d8f","#523d8f","#583d8f","#5f3d8f","#663d8f","#6d3d8f","#743d8f","#7a3d8f","#813d8f","#883d8f","#8f3d8f","#8f3d88","#8f3d81","#8f3d7a","#8f3d74","#8f3d6d","#8f3d66","#8f3d5f","#8f3d58","#8f3d52","#8f3d4b","#8f3d44"],ui=()=>{let e=0,t=5,o=[["license",["license"]],["config",["sfk","ini","yml","toml","iml"]],["model",["3ds","obj","ply","fbx"]],["database",["csv","json","sql","sqlite","sqlite3","npy","npz","rec","idx","hdf5"]],["text",["txt","md","mdx"]],["archive",["zip","rar","tar","tar.gz","7z"]],["image",pi],["video",di],["code",["html","php","css","sass","scss","less","cpp","h","hpp","c","xml"]],["info",["bib","readme","nfo"]],["key",["pem","pub"]],["lock",["lock","lock.json","shrinkwrap.json"]],["music",mi],["terminal",["run","sh"]],["trash",[".Trashes"]],["users",["authors","contributors"]],["linux",["AppImage"]],["ubuntu",["deb"]],["windows",["exe"]],["rust",["rs","rlib"]],["python",["py","ipynb"]],["nodejs",["js","jsx","ts","tsx","d.ts"]],["php",["php"]],["git",[".gitignore"]],["adobe",["psd"]],["pdf",["pdf"]],["excel",["xls","xlsx"]],["word",["doc","docx","odt"]],["flash",["swf"]]],r=new vr.default({ignoreCase:!0});for(let n of o){let[i,l]=n;for(let s=0;s<l.length;++s){e+=t;let a=e%(Io.length-1)+1,c={icon:i,colorCode:a};r.put(l[s],c,!0)}}return r},fi=ui(),Mr=e=>(0,Dt.useMemo)(()=>{if(!e)return{icon:"loading",colorCode:0};if(e.isDir===!0)return{icon:"folder",colorCode:0};let t=fi.getWithCheckpoints(e.name,".",!0);return t||{icon:"file",colorCode:32}},[e]);var Er=u(require("@material-ui/core/useMediaQuery")),Tr=u(require("classnames")),Ao=require("react-jss"),Pr={colors:{debugRed:"#fabdbd",debugBlue:"#bdd8fa",debugGreen:"#d2fabd",debugPurple:"#d2bdfa",debugYellow:"#fae9bd",textActive:"#09f"},fontSizes:{rootPrimary:15},margins:{rootLayoutMargin:8},toolbar:{size:30,lineHeight:"30px",fontSize:15,buttonRadius:4},dnd:{canDropColor:"green",cannotDropColor:"red",canDropMask:"rgba(180, 235, 180, 0.75)",cannotDropMask:"rgba(235, 180, 180, 0.75)",fileListCanDropMaskOne:"rgba(180, 235, 180, 0.1)",fileListCanDropMaskTwo:"rgba(180, 235, 180, 0.2)",fileListCannotDropMaskOne:"rgba(235, 180, 180, 0.1)",fileListCannotDropMaskTwo:"rgba(235, 180, 180, 0.2)"},dragLayer:{border:"solid 2px #09f",padding:"7px 10px",borderRadius:2},fileList:{desktopGridGutter:8,mobileGridGutter:5},gridFileEntry:{childrenCountSize:"1.6em",iconColorFocused:"#000",iconSize:"2.4em",iconColor:"#fff",borderRadius:5,fontSize:14,fileColorTint:"rgba(255, 255, 255, 0.4)",folderBackColorTint:"rgba(255, 255, 255, 0.1)",folderFrontColorTint:"rgba(255, 255, 255, 0.4)"},listFileEntry:{propertyFontSize:14,iconFontSize:"1.1em",iconBorderRadius:5,fontSize:14}},Nr={gridFileEntry:{fileColorTint:"rgba(50, 50, 50, 0.4)",folderBackColorTint:"rgba(50, 50, 50, 0.4)",folderFrontColorTint:"rgba(50, 50, 50, 0.15)"}},Lr={fontSizes:{rootPrimary:13},margins:{rootLayoutMargin:4},toolbar:{size:28,lineHeight:"28px",fontSize:13},gridFileEntry:{fontSize:13},listFileEntry:{propertyFontSize:12,iconFontSize:"1em",fontSize:13}},kt=()=>(0,Er.default)("(max-width:480px)"),vo=(e,t)=>`repeating-linear-gradient(45deg,${e},${e} 10px,${t} 0,${t} 20px)`,E=e=>(0,Ao.createUseStyles)(e),k=e=>{let t={},r=(0,Ao.createUseStyles)(n=>{let i=e(n),l={};return Object.keys(i).map(a=>{let c=`chonky-${a}`,d=`@global .${c}`;l[d]=i[a],t[a]=c}),l});return(...n)=>{let i=r(...n),l={};return Object.keys(t).map(s=>{l[s]=t[s]}),{...l,...i}}},y=e=>[e,"!important"],H=Tr.default;var At=u(require("react"));var Or=require("react"),It=require("react-redux");var zr=e=>{let t=(0,It.useStore)(),o=(0,It.useDispatch)();(0,Or.useImperativeHandle)(e,()=>({getFileSelection(){let r=ee(t.getState());return new Set(Object.keys(r))},setFileSelection(r,n=!0){let i=Array.from(r);o(g.selectFiles({fileIds:i,reset:n}))},requestFileAction(r,n){return Promise.resolve(o(I(r,n))).then()}}),[t,o])};var Rr=At.default.memo(At.default.forwardRef((e,t)=>(Ft(g.setRawFiles,e.files??Me.rawFiles),Ft(g.setRawFolderChain,e.folderChain),te(cr,G(e.fileActions,L.fileActions),G(e.disableDefaultFileActions,L.disableDefaultFileActions)),te(g.setExternalFileActionHandler,G(e.onFileAction,L.onFileAction)),te(g.setSelectionDisabled,G(e.disableSelection,L.disableSelection,"boolean")),te(gt,G(e.defaultSortActionId,L.defaultSortActionId)),te(dr,G(e.defaultFileViewActionId,L.defaultFileViewActionId,"string")),te(g.setThumbnailGenerator,G(e.thumbnailGenerator,L.thumbnailGenerator)),te(g.setDoubleClickDelay,G(e.doubleClickDelay,L.doubleClickDelay,"number")),te(g.setDisableDragAndDrop,G(e.disableDragAndDrop,L.disableDragAndDrop,"boolean")),te(g.setClearSelectionOnOutsideClick,G(e.clearSelectionOnOutsideClick,L.clearSelectionOnOutsideClick,"boolean")),zr(t),null)));Rr.displayName="ChonkyBusinessLogicInner";var wo=At.default.memo(Rr);wo.displayName="ChonkyBusinessLogic";var jr=u(require("@material-ui/core/Box")),Ur=u(require("@material-ui/core/ClickAwayListener")),de=u(require("react")),Pe=require("react-redux");var Qe=require("react"),Te=require("react-dnd"),vt=()=>{let e=(0,Qe.useContext)(Te.DndContext),{dragDropManager:t}=e;return!!t},Hr=(...e)=>{let t=vt(),o=(0,Qe.useCallback)(()=>[{},()=>null,()=>null],[]);return(t?Te.useDrag:o)(...e)},Br=(...e)=>{let t=vt(),o=(0,Qe.useCallback)(()=>[{},()=>null],[]);return(t?Te.useDrop:o)(...e)};var Mo=require("react"),Je=require("react-redux");var yi=e=>{let t=bt(e,o=>o.tagName&&o.tagName.toLowerCase()==="div"&&o.dataset&&o.dataset.chonkyFileId);return t?t.dataset.chonkyFileId:null},Gr=()=>{let e=(0,Je.useDispatch)(),t=ne((0,Je.useSelector)(go));return(0,Mo.useCallback)(o=>{if(!t.current||o.altKey)return;o.preventDefault();let r=yi(o.target);e(I(f.OpenFileContextMenu,{clientX:o.clientX,clientY:o.clientY,triggerFileId:r}))},[t,e])},Kr=()=>{let e=(0,Je.useDispatch)();return(0,Mo.useCallback)(()=>e(g.hideContextMenu()),[e])};var ge=u(require("react")),Vr=require("react-dnd");var ye="dnd-chonky-file-entry";var gi={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},bi=(e,t,o)=>{if(!e||!t||!o)return{display:"none"};let r=e.x+(o.x-t.x),n=e.y+(o.y-t.y),i=`translate(${r}px, ${n}px)`;return{transform:i,WebkitTransform:i}},_r=()=>{let e=Fi(),{itemType:t,item:o,initialCursorOffset:r,initialFileOffset:n,currentFileOffset:i,isDragging:l}=(0,Vr.useDragLayer)(a=>({item:a.getItem(),itemType:a.getItemType(),initialCursorOffset:a.getInitialClientOffset(),initialFileOffset:a.getInitialSourceClientOffset(),currentFileOffset:a.getSourceClientOffset(),isDragging:a.isDragging()}));if(!l||t!==ye||!o.payload)return null;let s=o.payload.selectedFiles.length;return ge.default.createElement("div",{style:gi},ge.default.createElement("div",{style:bi(r,n,i)},ge.default.createElement("div",{className:e.fileDragPreview},ge.default.createElement("b",null,o.payload.draggedFile.name),s>1&&ge.default.createElement(ge.default.Fragment,null," and ",ge.default.createElement("strong",null,s-1," other file",s-1!==1?"s":"")))))},Fi=k(e=>({fileDragPreview:{boxShadow:`2px 2px 5px ${e.palette.divider}`,backgroundColor:e.palette.background.default,borderRadius:e.dragLayer.borderRadius,fontSize:e.fontSizes.rootPrimary,color:e.palette.text.primary,padding:e.dragLayer.padding,border:e.dragLayer.border,display:"inline-block"}}));var Eo=u(require("hotkeys-js")),wt=u(require("react")),Wr=require("react-redux");var $r=wt.default.memo(e=>{let{fileActionId:t}=e,o=(0,Wr.useDispatch)(),r=_(se,t);return(0,wt.useEffect)(()=>{if(!r||!r.hotkeys||r.hotkeys.length===0)return;let n=r.hotkeys.join(","),i=l=>{l.preventDefault(),o(I(r,void 0))};return(0,Eo.default)(n,i),()=>Eo.default.unbind(n,i)},[o,r]),null});var qr=({children:e})=>{let t=(0,Pe.useDispatch)(),o=(0,Pe.useSelector)(Qt),r=(0,Pe.useSelector)(je),n=(0,Pe.useSelector)(yo),i=(0,de.useCallback)(d=>{!n||fr(d.target)||t(g.clearSelection())},[t,n]),l=(0,de.useMemo)(()=>o.map(d=>de.default.createElement($r,{key:`file-action-listener-${d}`,fileActionId:d})),[o]),s=vt(),a=Gr(),c=hi();return de.default.createElement(Ur.default,{onClickAway:i},de.default.createElement(jr.default,{className:c.chonkyRoot,onContextMenu:a},!r&&s&&de.default.createElement(_r,null),l,e||null))},hi=k(e=>({chonkyRoot:{backgroundColor:e.palette.background.paper,border:`solid 1px ${e.palette.divider}`,padding:e.margins.rootLayoutMargin,fontSize:e.fontSizes.rootPrimary,color:e.palette.text.primary,touchAction:"manipulation",fontFamily:"sans-serif",flexDirection:"column",boxSizing:"border-box",textAlign:"left",borderRadius:4,display:"flex",height:"100%",webkitTouchCallout:"none",webkitUserSelect:"none",mozUserSelect:"none",msUserSelect:"none",userSelect:"none"}}));var et=K.default.forwardRef((e,t)=>{let{instanceId:o,iconComponent:r,children:n}=e,i=G(e.disableDragAndDrop,L.disableDragAndDrop,"boolean"),l=G(e.disableDragAndDropProvider,L.disableDragAndDropProvider,"boolean"),s=G(e.darkMode,L.darkMode,"boolean"),a=G(e.i18n,L.i18n),c=(0,K.useMemo)(()=>({...Ze,...a==null?void 0:a.formatters}),[a]),d=dt(()=>o??en.default.generate()),p=Do(d),b=kt(),h=(0,K.useMemo)(()=>{let S=(0,Et.createMuiTheme)({palette:{type:s?"dark":"light"}}),w=(0,Mt.default)(S,(0,Mt.default)(Pr,s?Nr:{}));return b?(0,Mt.default)(w,Lr):w},[s,b]),C=K.default.createElement(K.default.Fragment,null,K.default.createElement(wo,{ref:t,...e}),K.default.createElement(qr,null,n));return K.default.createElement(Zr.IntlProvider,{locale:"en",defaultLocale:"en",...a},K.default.createElement(ko.Provider,{value:c},K.default.createElement(Jr.Provider,{store:p},K.default.createElement(Qr.ThemeProvider,{theme:h},K.default.createElement(Et.ThemeProvider,{theme:h},K.default.createElement(M.Provider,{value:r??L.iconComponent??Ee},i||l?C:K.default.createElement(Yr.DndProvider,{backend:Xr.HTML5Backend},C)))))))});et.displayName="FileBrowser";var Po=u(require("@material-ui/core/Box")),pn=u(require("@material-ui/core/Breadcrumbs")),pe=u(require("react"));var tn=require("react"),Tt=require("react-redux");var on=()=>{let e=(0,Tt.useSelector)(he),t=(0,Tt.useDispatch)();return(0,tn.useMemo)(()=>{let r=[];if(!e)return r;for(let n=0;n<e.length;++n){let i=e[n];r.push({file:i,disabled:!i,onClick:!F.isOpenable(i)||n===e.length-1?void 0:()=>t(I(f.OpenFiles,{targetFile:i,files:[i]}))})}return r},[t,e])};var ae=u(require("react"));var W=require("react"),rn=require("react-dnd-html5-backend"),be=require("react-redux");var Si=e=>{let t=(0,be.useStore)(),o=ne(e),r=(0,W.useCallback)(()=>{let h=t.getState();return{sourceInstanceId:Ke(h),source:ve(h),draggedFile:o.current,selectedFiles:$e(h)}},[t,o]),n=(0,be.useDispatch)(),i=(0,W.useCallback)(()=>F.isDraggable(o.current),[o]),l=(0,W.useCallback)(()=>{let h={type:ye,payload:r()};return n(I(f.StartDragNDrop,h.payload)),h},[n,r]),s=(0,W.useCallback)((h,C)=>{let S=C.getDropResult();!F.isDraggable(h.payload.draggedFile)||!S||!S.dropTarget||n(I(f.EndDragNDrop,{...h.payload,destination:S.dropTarget,copy:S.dropEffect==="copy"}))},[n]),a=(0,W.useMemo)(()=>({type:ye,payload:{}}),[]),c=(0,W.useCallback)(h=>({isDragging:h.isDragging()}),[]),[{isDragging:d},p,b]=Hr({item:a,canDrag:i,begin:l,end:s,collect:c});return(0,W.useEffect)(()=>{b((0,rn.getEmptyImage)(),{captureDraggingState:!0})},[b]),{dndIsDragging:d,drag:p}},tt=({file:e,forceDisableDrop:t,includeChildrenDrops:o})=>{let r=ne((0,be.useSelector)(he)),n=(0,W.useCallback)((p,b)=>b.canDrop()?{dropTarget:e}:void 0,[e]),i=(0,W.useCallback)((p,b)=>{if(t||!F.isDroppable(e)||!b.isOver({shallow:!0})&&!o)return!1;let{source:h,draggedFile:C,selectedFiles:S}=p.payload,w=new Set;w.add(e.id),r.current.map(x=>{x&&w.add(x.id)});let N=[C,...S];for(let x of N)if(w.has(x.id))return!1;return e.id!==(h==null?void 0:h.id)},[t,e,o,r]),l=(0,W.useCallback)(p=>({isOver:p.isOver(),isOverCurrent:p.isOver({shallow:!0}),canDrop:p.canDrop()}),[]),[{isOver:s,isOverCurrent:a,canDrop:c},d]=Br({accept:ye,drop:n,canDrop:i,collect:l});return{dndIsOver:s,dndIsOverCurrent:a,dndCanDrop:c,drop:d}},nn=e=>{let{dndIsDragging:t,drag:o}=Si(e),{dndIsOver:r,dndCanDrop:n,drop:i}=tt({file:e}),l=(0,W.useMemo)(()=>({dndIsDragging:t,dndIsOver:r,dndCanDrop:n}),[n,t,r]);return{drop:i,drag:o,dndState:l}},Pt=(e,t)=>{let o=(0,be.useDispatch)(),r=ne((0,be.useSelector)(ve));(0,W.useEffect)(()=>{var i;let n=null;return t.dndIsOver&&F.isDndOpenable(e)&&e.id!==((i=r.current)==null?void 0:i.id)&&(n=setTimeout(()=>o(I(we.OpenFiles,{targetFile:e,files:[e]})),1500)),()=>{n&&clearTimeout(n)}},[o,e,t.dndIsOver,r])};var A=u(require("react")),Nt=require("react-redux");var To=u(require("react"));var Ci=(e,t)=>e+Math.floor(Math.random()*Math.floor(t-e)),Fe=To.default.memo(e=>{let{minLength:t,maxLength:o}=e,r=Ci(t,o),n="&nbsp;".repeat(r),i=xi();return To.default.createElement("span",{className:i.textPlaceholder,dangerouslySetInnerHTML:{__html:n}})}),xi=E(()=>({"@keyframes loading-placeholder":{"0%":{opacity:.2},"50%":{opacity:.4},"100%":{opacity:.2}},textPlaceholder:{animationName:"$loading-placeholder",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDuration:"1.5s",backgroundColor:"#ccc",whiteSpace:"nowrap",overflow:"hidden",borderRadius:4,maxWidth:"40%",minWidth:20}}));var Ne=e=>(0,A.useMemo)(()=>({role:"listitem",...{"data-test-id":"file-entry","data-chonky-file-id":e?e.id:void 0}}),[e]),Le=(e,t,o)=>{let r=Mr(e),{thumbnailUrl:n,thumbnailLoading:i}=ki(e);return(0,A.useMemo)(()=>{let l=n?wr[r.colorCode]:Io[r.colorCode],s=i||!e,a=i?"loading":r.icon;return{childrenCount:F.getChildrenCount(e),icon:e&&e.icon!==void 0?e.icon:a,iconSpin:s,thumbnailUrl:n,color:e&&e.color!==void 0?e.color:l,selected:t,focused:!!o}},[e,o,r,t,i,n])},Oe=e=>{let t=null;return e.dndIsOver?t=e.dndCanDrop?"dndCanDrop":"dndCannotDrop":e.dndIsDragging&&(t="dndDragging"),t},ln=e=>{let t=(0,A.useMemo)(()=>{let n=[];return F.isHidden(e)&&n.push("hidden"),F.isSymlink(e)&&n.push("symlink"),F.isEncrypted(e)&&n.push("lock"),n},[e]),o=(0,A.useContext)(M);return(0,A.useMemo)(()=>t.map((n,i)=>A.default.createElement(o,{key:`file-modifier-${i}`,icon:n,file:e})),[o,t])},Di=e=>{let t=e.split(".");return t.length?`.${t[t.length-1]}`:""},sn=e=>(0,A.useMemo)(()=>{if(!e)return A.default.createElement(Fe,{minLength:15,maxLength:20});let t,o=null;return F.isDirectory(e)?t=e.name:(o=(e==null?void 0:e.ext)??Di(e==null?void 0:e.name),t=e==null?void 0:e.name.substr(0,(e==null?void 0:e.name.length)-o.length)),A.default.createElement("div",{className:"chonky-file-name"},e.sortName??t,o&&A.default.createElement("span",{className:"chonky-file-entry-description-title-extension"},o),A.default.createElement("span",{className:"chonky-file-title"},e.name))},[e]),ki=e=>{let t=(0,Nt.useSelector)(uo),[o,r]=(0,A.useState)(null),[n,i]=(0,A.useState)(!1),l=(0,A.useRef)(0);return(0,A.useEffect)(()=>{let s=!1;return e&&(t?(l.current===0&&i(!0),l.current++,Promise.resolve().then(()=>t(e)).then(a=>{s||(i(!1),a&&typeof a=="string"&&r(a))}).catch(a=>{s||i(!1),P.error(`User-defined "thumbnailGenerator" handler threw an error: ${a.message}`)})):e.thumbnailUrl&&r(e.thumbnailUrl)),()=>{s=!0}},[e,r,i,t]),{thumbnailUrl:o,thumbnailLoading:n}},an=(e,t)=>{let o=(0,Nt.useDispatch)(),r=(0,A.useCallback)((s,a)=>{!e||o(I(f.MouseClickFile,{clickType:a,file:e,fileDisplayIndex:t,altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey}))},[o,e,t]),n=(0,A.useCallback)(s=>{!e||o(I(f.KeyboardClickFile,{file:e,fileDisplayIndex:t,enterKey:s.enterKey,spaceKey:s.spaceKey,altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey}))},[o,e,t]),i=(0,A.useCallback)(s=>r(s,"single"),[r]),l=(0,A.useCallback)(s=>r(s,"double"),[r]);return{onSingleClick:i,onDoubleClick:l,onKeyboardClick:n}};var cn=u(require("@material-ui/core/Button")),X=u(require("react"));var ze=(n=>(n[n.Hidden=0]="Hidden",n[n.Disabled=1]="Disabled",n[n.Default=2]="Default",n[n.Active=3]="Active",n))(ze||{});var Lt=require("react"),De=require("react-redux");var Ot=e=>{let t=(0,De.useDispatch)(),o=_(se,e);return(0,Lt.useCallback)(()=>t(I(o,void 0)),[t,o])},zt=e=>{var c;let t=(0,De.useSelector)(_e),o=(0,De.useSelector)(ce),r=(0,De.useSelector)(co),n=(0,De.useSelector)(po),i=_(se,e),l=_(mo,(c=i==null?void 0:i.option)==null?void 0:c.id),a=_(so,e)===0;return(0,Lt.useMemo)(()=>{var x;if(!i)return{icon:null,active:!1,disabled:!0};let d=((x=i.button)==null?void 0:x.icon)??null;i.sortKeySelector?r===i.id?n==="asc"?d="sortAsc":d="sortDesc":d="placeholder":i.option&&(l?d="toggleOn":d="toggleOff");let p=i.id===r,b=i.fileViewConfig===o,h=i.option?!!l:!1,C=!1,S=!1;i.customVisibility!==void 0&&(C=i.customVisibility()===1,S=i.customVisibility()===3);let w=p||b||h||S,N=!!i.requiresSelection&&a||C;return i.id===f.OpenParentFolder.id&&(N=N||!F.isOpenable(t)),{icon:d,active:w,disabled:N}},[t,o,r,n,i,l,a])};var ot=X.default.memo(e=>{let{className:t,text:o,tooltip:r,active:n,icon:i,iconOnly:l,onClick:s,disabled:a,dropdown:c}=e,d=Ii(),p=(0,X.useContext)(M),b=i||l?X.default.createElement("div",{className:l?"":d.iconWithText},X.default.createElement(p,{icon:i||"fallbackIcon",fixedWidth:!0})):null,h=H({[t??""]:!0,[d.baseButton]:!0,[d.iconOnlyButton]:l,[d.activeButton]:!!n});return X.default.createElement(cn.default,{className:h,onClick:s,title:r||o,disabled:a||!s},b,o&&!l&&X.default.createElement("span",null,o),c&&X.default.createElement("div",{className:d.iconDropdown},X.default.createElement(p,{icon:i||"dropdown",fixedWidth:!0})))}),Ii=k(e=>({baseButton:{fontSize:y(e.toolbar.fontSize),textTransform:y("none"),letterSpacing:y(0),minWidth:y("auto"),lineHeight:e.toolbar.lineHeight,height:e.toolbar.size,paddingBottom:y(0),paddingTop:y(0)},iconWithText:{marginRight:8},iconOnlyButton:{width:e.toolbar.size,textAlign:"center"},iconDropdown:{fontSize:"0.7em",marginLeft:2,marginTop:1},activeButton:{color:y(e.colors.textActive)}})),Rt=X.default.memo(e=>{let{fileActionId:t}=e,o=_(se,t),r=Ot(t),{icon:n,active:i,disabled:l}=zt(t),{buttonName:s,buttonTooltip:a}=Ct(o);if(!o)return null;let{button:c}=o;return!c||o.customVisibility!==void 0&&o.customVisibility()===0?null:X.default.createElement(ot,{text:s,tooltip:a,icon:n,iconOnly:c.iconOnly,active:i,onClick:r,disabled:l})});var dn=ae.default.memo(({first:e,current:t,item:o})=>{let{file:r,disabled:n,onClick:i}=o,{dndIsOver:l,dndCanDrop:s,drop:a}=tt({file:r,forceDisableDrop:!r||t}),c=(0,ae.useMemo)(()=>({dndIsOver:l,dndCanDrop:s,dndIsDragging:!1}),[s,l]);Pt(r,c);let d=Oe(c),p=(0,ae.useContext)(M),b=Ai(c),h=H({[b.baseBreadcrumb]:!0,[b.disabledBreadcrumb]:n,[b.currentBreadcrumb]:t}),C=r?r.name:"Loading...",S=e&&(r==null?void 0:r.folderChainIcon)===void 0?"folder":r==null?void 0:r.folderChainIcon;return ae.default.createElement("div",{className:b.buttonContainer,ref:r?a:null},r&&d&&ae.default.createElement("div",{className:b.dndIndicator},ae.default.createElement(p,{icon:d,fixedWidth:!0})),ae.default.createElement(ot,{icon:S,className:h,text:C,disabled:n,onClick:i}))}),Ai=E(e=>({buttonContainer:{position:"relative"},baseBreadcrumb:{color:t=>{let o=e.palette.text.primary;return t.dndIsOver&&(o=t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor),y(o)}},disabledBreadcrumb:{color:()=>y(e.palette.text.disabled)},currentBreadcrumb:{textDecoration:y("underline")},dndIndicator:{color:t=>t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor,backgroundColor:t=>t.dndCanDrop?e.dnd.canDropMask:e.dnd.cannotDropMask,lineHeight:`calc(${e.toolbar.lineHeight} - 6px)`,transform:"translateX(-50%) translateY(-50%)",borderRadius:e.toolbar.buttonRadius,height:e.toolbar.size-6,width:e.toolbar.size-6,boxSizing:"border-box",position:"absolute",textAlign:"center",left:"50%",top:"50%",zIndex:5}}));var Ht=pe.default.memo(()=>{let e=vi(),t=on(),o=(0,pe.useMemo)(()=>{let r=[];for(let n=0;n<t.length;++n){let i=`folder-chain-${n}`,l=pe.default.createElement(dn,{key:i,first:n===0,current:n===t.length-1,item:t[n]});r.push(l)}return r},[t]);return pe.default.createElement(Po.default,{className:e.navbarWrapper},pe.default.createElement(Po.default,{className:e.navbarContainer},pe.default.createElement(Rt,{fileActionId:f.OpenParentFolder.id}),pe.default.createElement(pn.default,{className:e.navbarBreadcrumbs,classes:{separator:e.separator}},o)))}),vi=k(e=>({navbarWrapper:{paddingBottom:e.margins.rootLayoutMargin},navbarContainer:{display:"flex"},upDirectoryButton:{fontSize:y(e.toolbar.fontSize),height:e.toolbar.size,width:e.toolbar.size,padding:"0px !important"},navbarBreadcrumbs:{fontSize:y(e.toolbar.fontSize),flexGrow:100},separator:{marginRight:y(4),marginLeft:y(4)}}));var Q=u(require("react")),kn=require("react-redux");var yn=u(require("@material-ui/core/Menu")),Y=u(require("react"));var mn=u(require("@material-ui/core/ListItemIcon")),un=u(require("@material-ui/core/ListItemText")),fn=u(require("@material-ui/core/MenuItem")),Z=u(require("react"));var wi=Z.default.forwardRef((e,t)=>{let{text:o,active:r,icon:n,onClick:i,disabled:l}=e,s=Mi(),a=(0,Z.useContext)(M),c=H({[s.baseButton]:!0,[s.activeButton]:r});return Z.default.createElement(fn.default,{ref:t,className:c,onClick:i,disabled:l},n&&Z.default.createElement(mn.default,{className:s.icon},Z.default.createElement(a,{icon:n,fixedWidth:!0})),Z.default.createElement(un.default,{primaryTypographyProps:{className:s.text}},o))}),Mi=k(e=>({baseButton:{lineHeight:y(e.toolbar.lineHeight),height:y(e.toolbar.size),minHeight:y("auto"),minWidth:y("auto"),padding:y(20)},icon:{fontSize:y(e.toolbar.fontSize),minWidth:y("auto"),color:y("inherit"),marginRight:8},text:{fontSize:y(e.toolbar.fontSize)},activeButton:{color:y(e.colors.textActive)}})),rt=Z.default.forwardRef((e,t)=>{let{fileActionId:o,onClickFollowUp:r}=e,n=_(se,o),i=Ot(o),{icon:l,active:s,disabled:a}=zt(o),{buttonName:c}=Ct(n),d=(0,Z.useCallback)(()=>{i(),r&&r()},[r,i]);if(!n)return null;let{button:p}=n;return!p||n.customVisibility!==void 0&&n.customVisibility()===0?null:Z.default.createElement(wi,{ref:t,text:c,icon:l,onClick:d,active:s,disabled:a})});var gn=Y.default.memo(e=>{let{name:t,fileActionIds:o}=e,[r,n]=Y.default.useState(null),i=(0,Y.useCallback)(d=>n(d.currentTarget),[n]),l=(0,Y.useCallback)(()=>n(null),[n]),s=(0,Y.useMemo)(()=>o.map(d=>Y.default.createElement(rt,{key:`menu-item-${d}`,fileActionId:d,onClickFollowUp:l})),[o,l]),a=Ar(t),c=Ei();return Y.default.createElement(Y.default.Fragment,null,Y.default.createElement(ot,{text:a,onClick:i,dropdown:!0}),Y.default.createElement(yn.default,{autoFocus:!0,keepMounted:!0,elevation:2,anchorEl:r,onClose:l,open:Boolean(r),transitionDuration:150,classes:{list:c.dropdownList}},s))}),Ei=k(()=>({dropdownList:{paddingBottom:y(0),paddingTop:y(0)}}));var ke=u(require("react")),bn=require("react-intl"),Bt=require("react-redux"),Fn=u(require("@material-ui/core/Typography"));var hn=ke.default.memo(()=>{let e=Ti(),t=(0,Bt.useSelector)($.getDisplayFileIds),o=(0,Bt.useSelector)(We),r=(0,Bt.useSelector)(ro),n=(0,bn.useIntl)(),i=n.formatMessage({id:q("toolbar","visibleFileCount"),defaultMessage:`{fileCount, plural,
                =0 {# items}
                one {# item}
                other {# items}
            }`},{fileCount:t.length}),l=n.formatMessage({id:q("toolbar","selectedFileCount"),defaultMessage:`{fileCount, plural,
                =0 {}
                other {# selected}
            }`},{fileCount:o}),s=n.formatMessage({id:q("toolbar","hiddenFileCount"),defaultMessage:`{fileCount, plural,
                =0 {}
                other {# hidden}
            }`},{fileCount:r});return ke.default.createElement("div",{className:e.infoContainer},ke.default.createElement(Fn.default,{className:e.infoText,variant:"body1"},i,(l||s)&&ke.default.createElement("span",{className:e.extraInfoSpan},"(",ke.default.createElement("span",{className:e.selectionSizeText},l),l&&s&&", ",ke.default.createElement("span",{className:e.hiddenCountText},s),")")))}),Ti=k(e=>({infoContainer:{height:e.toolbar.size,display:"flex"},infoText:{lineHeight:y(e.toolbar.lineHeight),fontSize:y(e.toolbar.fontSize),marginLeft:y(12),height:e.toolbar.size},extraInfoSpan:{marginRight:y(8),marginLeft:y(8),opacity:.8},selectionSizeText:{color:e.colors.textActive},hiddenCountText:{}}));var B=u(require("react")),Sn=require("react-intl"),Gt=require("react-redux"),Cn=u(require("@material-ui/core/InputAdornment")),xn=u(require("@material-ui/core/TextField"));var Dn=B.default.memo(()=>{let t=(0,Sn.useIntl)().formatMessage({id:q("toolbar","searchPlaceholder"),defaultMessage:"Search"}),o=Pi(),r=(0,B.useContext)(M),n=(0,B.useRef)(),i=(0,Gt.useDispatch)(),l=(0,Gt.useSelector)(io),[s,a]=(0,B.useState)(l),[c]=$o(s,300),[d,p]=(0,B.useState)(!1);(0,B.useEffect)(()=>(i(g.setFocusSearchInput(()=>{n.current&&n.current.focus()})),()=>{i(g.setFocusSearchInput(null))}),[i]),(0,B.useEffect)(()=>{p(!1),i(g.setSearchString(c))},[c,i]);let b=(0,B.useCallback)(C=>{p(!0),a(C.currentTarget.value)},[]),h=(0,B.useCallback)(C=>{C.key==="Escape"&&(a(""),i(g.setSearchString("")),n.current&&n.current.blur())},[i]);return B.default.createElement(xn.default,{className:o.searchFieldContainer,size:"small",variant:"outlined",value:s,placeholder:t,onChange:b,inputRef:n,InputProps:{onKeyUp:h,startAdornment:B.default.createElement(Cn.default,{className:o.searchIcon,position:"start"},B.default.createElement(r,{icon:d?"loading":"search",spin:d})),className:o.searchFieldInput},inputProps:{className:o.searchFieldInputInner}})}),Pi=k(e=>({searchFieldContainer:{height:e.toolbar.size,width:150},searchIcon:{fontSize:"0.9em",opacity:.75},searchFieldInput:{lineHeight:y(0),padding:y(0),margin:y(0),fontSize:y(e.toolbar.fontSize),borderRadius:e.toolbar.buttonRadius,height:e.toolbar.size-4,paddingLeft:y(8),marginTop:2},searchFieldInputInner:{lineHeight:y(`${e.toolbar.size-4}px`),fontSize:y(e.toolbar.fontSize),height:y(e.toolbar.size-4),padding:y([0,8,0,0]),margin:y(0),"-webkit-appearance":"none"}}));var Kt=Q.default.memo(()=>{let e=Ni(),t=(0,kn.useSelector)(Jt),o=(0,Q.useMemo)(()=>{let r=[];for(let n=0;n<t.length;++n){let i=t[n],l=`toolbar-item-${typeof i=="string"?i:i.name}`,s=typeof i=="string"?Q.default.createElement(Rt,{key:l,fileActionId:i}):Q.default.createElement(gn,{key:l,name:i.name,fileActionIds:i.fileActionIds});r.push(s)}return r},[t]);return Q.default.createElement("div",{className:e.toolbarWrapper},Q.default.createElement("div",{className:e.toolbarContainer},Q.default.createElement("div",{className:e.toolbarLeft},Q.default.createElement(Dn,null),Q.default.createElement(hn,null)),Q.default.createElement("div",{className:e.toolbarRight},o)))}),Ni=k(e=>({toolbarWrapper:{},toolbarContainer:{flexWrap:"wrap-reverse",display:"flex"},toolbarLeft:{paddingBottom:e.margins.rootLayoutMargin,flexWrap:"nowrap",flexGrow:1e4,display:"flex"},toolbarLeftFiller:{flexGrow:1e4},toolbarRight:{paddingBottom:e.margins.rootLayoutMargin,flexWrap:"nowrap",display:"flex"}}));var V=u(require("react")),jt=require("react-redux"),Vn=u(require("react-virtualized-auto-sizer"));var Re=u(require("react")),In=require("react-intl");var An=e=>{let{width:t,height:o}=e,r=Li(),n=(0,Re.useContext)(M),i={width:t,height:o},s=(0,In.useIntl)().formatMessage({id:q("fileList","nothingToShow"),defaultMessage:"Nothing to show"});return Re.default.createElement("div",{className:r.fileListEmpty,style:i},Re.default.createElement("div",{className:r.fileListEmptyContent},Re.default.createElement(n,{icon:"folderOpen"}),"\xA0 ",s))},Li=k(e=>({fileListEmpty:{color:e.palette.text.disabled,position:"relative",textAlign:"center",fontSize:"1.2em"},fileListEmptyContent:{transform:"translateX(-50%) translateY(-50%)",position:"absolute",left:"50%",top:"50%"}}));var R=u(require("react")),$t=require("react-redux"),Hn=require("react-window");var me=u(require("react")),zn=require("react-redux");var it=u(require("react"));var nt=require("react"),vn=require("react-redux");var wn=(e,t)=>{let o=(0,vn.useSelector)(fo),r=(0,nt.useRef)({clickCount:0,clickTimeout:null});return(0,nt.useCallback)(n=>{let i={altKey:n.altKey,ctrlKey:n.ctrlKey||n.metaKey,shiftKey:n.shiftKey};r.current.clickCount++,r.current.clickCount===1?(e&&(n.preventDefault(),e(i)),r.current.clickCount=1,r.current.clickTimeout=setTimeout(()=>r.current.clickCount=0,o)):r.current.clickCount===2&&(t&&(n.preventDefault(),t(i)),typeof r.current.clickTimeout=="number"&&(clearTimeout(r.current.clickTimeout),r.current.clickTimeout=null,r.current.clickCount=0))},[o,e,t,r])},Mn=e=>(0,nt.useCallback)(t=>{if(!e)return;let o={enterKey:t.nativeEvent.code==="Enter",spaceKey:t.nativeEvent.code==="Space",altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey};(o.spaceKey||o.enterKey)&&(t.preventDefault(),t.stopPropagation(),e(o))},[e]);var No=e=>{let{children:t,wrapperTag:o,passthroughProps:r,onSingleClick:n,onDoubleClick:i,onKeyboardClick:l,setFocused:s}=e,a=wn(n,i),c=Mn(l),d={onFocus:(0,it.useCallback)(()=>s&&s(!0),[s]),onBlur:(0,it.useCallback)(()=>s&&s(!1),[s])};(n||i||l)&&(d.onClick=a,d.onKeyDown=c,d.tabIndex=0);let p={...d,...r};return it.default.createElement(o,{...p},t)};var O=u(require("react"));var He=u(require("react"));var Ie=He.default.memo(({file:e,className:t})=>{var l;let o=ln(e),r=sn(e),n=(l=e==null?void 0:e.tags)==null?void 0:l.split(",").filter(s=>Boolean(s)),i=Oi();return He.default.createElement("span",{className:t,title:e?e.name:void 0},o.length>0&&He.default.createElement("span",{className:i.modifierIcons},o),r,n!=null&&n.length?He.default.createElement("div",{className:"chonky-tags"},n==null?void 0:n.map((s,a)=>He.default.createElement("span",{className:"tags-"+a.toString()+"-"+s,key:a.toString()+s},s))):null)});Ie.displayName="FileEntryName";var Oi=E(e=>({modifierIcons:{color:e.palette.text.hint,position:"relative",fontSize:"0.775em",paddingRight:5}}));var En=O.default.memo(({file:e,selected:t,focused:o,dndState:r})=>{let n=Le(e,t,o),{fileModDateString:i,fileSizeString:l}=xt(e),s=zi(n),a=(0,O.useContext)(M),c=Ne(e);return O.default.createElement("div",{className:s.listFileEntry,...c},O.default.createElement("div",{className:s.listFileEntryIcon},O.default.createElement(a,{icon:n.icon,spin:n.iconSpin,fixedWidth:!0})),O.default.createElement("div",{className:s.listFileEntryDescription},O.default.createElement("div",{className:s.listFileEntryName,title:e?e.name:void 0},O.default.createElement(Ie,{file:e})),O.default.createElement("div",{className:s.listFileEntryProperties},O.default.createElement("div",{className:s.listFileEntryProperty},e?i??O.default.createElement("span",null,"\u2014"):O.default.createElement(Fe,{minLength:5,maxLength:15})),O.default.createElement("div",{className:s.listFileEntryProperty},e?l??O.default.createElement("span",null,"\u2014"):O.default.createElement(Fe,{minLength:10,maxLength:20})))),O.default.createElement("div",{className:"chonky-file-entry-outline"}),O.default.createElement("div",{className:"chonky-file-entry-selection"}))}),zi=E(e=>({listFileEntry:{fontSize:e.listFileEntry.fontSize,alignItems:"center",position:"relative",display:"flex",height:"100%"},listFileEntryIcon:{backgroundColor:t=>t.color,boxShadow:"inset rgba(255, 255, 255, 0.5) 0 0 0 999px",borderRadius:e.listFileEntry.iconBorderRadius,fontSize:e.listFileEntry.iconFontSize,color:"#fff",padding:8},listFileSearch:{},listFileEntryDescription:{flexDirection:"column",display:"flex",flexGrow:1},listFileEntryName:{padding:[0,8,4,8]},listFileEntryProperties:{fontSize:e.listFileEntry.propertyFontSize,flexDirection:"row",display:"flex"},listFileEntryProperty:{padding:[0,8],opacity:.4}}));var Vt=u(require("react"));var Tn=Vt.default.memo(({file:e,children:t})=>{let{drop:o,drag:r,dndState:n}=nn(e);Pt(e,n);let i=Ri();return Vt.default.createElement("div",{ref:o,className:i.fillParent},Vt.default.createElement("div",{ref:F.isDraggable(e)?r:null,className:i.fillParent},t(n)))}),Ri=E(()=>({fillParent:{height:"100%"}}));var Ae=u(require("react"));var z=u(require("react"));var Pn=u(require("classnames")),Lo=u(require("react"));var _t=Lo.default.memo(e=>{let{className:t,thumbnailUrl:o}=e,r=o?{backgroundImage:`url('${o}')`}:{},n=Hi();return Lo.default.createElement("div",{className:(0,Pn.default)([t,n.fileThumbnail]),style:r})});_t.displayName="FileThumbnail";var Hi=k(()=>({fileThumbnail:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain"}}));var Be=u(require("react"));var Oo=Be.default.memo(e=>{let{className:t,dndState:o}=e,r=Oe(o),n=Bi(o),i=(0,Be.useContext)(M);if(!r)return null;let l=H({[n.dndIndicator]:!0,[t]:!0});return Be.default.createElement("div",{className:l},Be.default.createElement(i,{icon:r}))}),Bi=E(e=>({dndIndicator:{color:t=>t.dndIsOver?t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:"#000",boxSizing:"border-box",position:"absolute",fontSize:"1.2em",opacity:.6,padding:6,"&:before":{borderBottom:"50px solid transparent",borderLeft:"50px solid #fff",position:"absolute",content:'""',zIndex:-1,left:0,top:0}}}));var zo=z.default.memo(e=>{let{className:t,entryState:o,dndState:r}=e,n=Gi(o),i=Nn(o),l=Wt(o),s=H({[n.previewFile]:!0,[t||""]:!!t});return z.default.createElement("div",{className:s},z.default.createElement("div",{className:n.folderBackSideMid},z.default.createElement("div",{className:n.folderBackSideTop}),z.default.createElement("div",{className:n.folderFrontSide},z.default.createElement(Oo,{className:i.dndIndicator,dndState:r}),z.default.createElement("div",{className:H([i.fileIcon,n.fileIcon])},o.childrenCount),z.default.createElement("div",{className:l.selectionIndicator}),z.default.createElement(_t,{className:i.thumbnail,thumbnailUrl:o.thumbnailUrl}))))});zo.displayName="GridEntryPreviewFolder";var Gi=E(e=>({previewFile:{borderRadius:e.gridFileEntry.borderRadius,position:"relative",overflow:"hidden"},folderBackSideTop:{backgroundColor:t=>t.color,boxShadow:t=>{let o=e.gridFileEntry.folderBackColorTint;return t.focused?o="rgba(0, 0, 0, 0.3)":t.selected&&(o="rgba(0, 153, 255, .4)"),`inset ${o} 0 0 0 999px`},borderTopLeftRadius:e.gridFileEntry.borderRadius,borderTopRightRadius:10,position:"absolute",right:"60%",height:13,top:-10,left:0,"&:after":{borderRightColor:e.palette.background.paper,borderTopColor:e.palette.background.paper,borderBottomColor:"transparent",borderLeftColor:"transparent",borderWidth:[0,15,10,0],borderStyle:"solid",position:"absolute",display:"block",content:'""',right:0,top:0}},folderBackSideMid:{backgroundColor:t=>t.color,boxShadow:t=>{let o=e.gridFileEntry.folderBackColorTint;return t.focused?o="rgba(0, 0, 0, 0.3)":t.selected&&(o="rgba(0, 153, 255, .4)"),`inset ${o} 0 0 0 999px`},borderTopRightRadius:e.gridFileEntry.borderRadius,position:"absolute",bottom:0,right:0,left:0,top:10},folderFrontSide:{boxShadow:t=>{let o=[];return t.focused&&o.push("inset rgba(0, 0, 0, 1) 0 0 0 3px"),t.selected&&o.push("inset rgba(0, 153, 255, .65) 0 0 0 3px"),o.push(`inset ${e.gridFileEntry.folderFrontColorTint} 0 0 0 999px`),o.join(", ")},backgroundColor:t=>t.color,borderRadius:e.gridFileEntry.borderRadius,position:"absolute",overflow:"hidden",bottom:0,right:0,left:0,top:10},fileIcon:{fontSize:y(e.gridFileEntry.childrenCountSize)}})),Ro=z.default.memo(e=>{let{className:t,entryState:o,dndState:r}=e,n=Nn(o),i=Wt(o),l=(0,z.useContext)(M),s=H({[n.previewFile]:!0,[t||""]:!!t});return z.default.createElement("div",{className:s},z.default.createElement(Oo,{className:n.dndIndicator,dndState:r}),z.default.createElement("div",{className:n.fileIcon},z.default.createElement(l,{icon:o.icon,spin:o.iconSpin})),z.default.createElement("div",{className:i.selectionIndicator}),z.default.createElement(_t,{className:n.thumbnail,thumbnailUrl:o.thumbnailUrl}))});Ro.displayName="GridEntryPreviewFile";var Nn=E(e=>({previewFile:{boxShadow:t=>{let o=[];return t.selected&&o.push("inset rgba(0,153,255, .65) 0 0 0 3px"),t.focused&&o.push("inset rgba(0, 0, 0, 1) 0 0 0 3px"),o.push(`inset ${e.gridFileEntry.fileColorTint} 0 0 0 999px`),o.join(", ")},backgroundColor:t=>t.color,borderRadius:e.gridFileEntry.borderRadius,position:"relative",overflow:"hidden"},dndIndicator:{zIndex:14},fileIcon:{transform:"translateX(-50%) translateY(-50%)",fontSize:e.gridFileEntry.iconSize,opacity:t=>t.thumbnailUrl&&!t.focused?0:1,color:t=>t.focused?e.gridFileEntry.iconColorFocused:e.gridFileEntry.iconColor,position:"absolute",left:"50%",zIndex:12,top:"50%"},thumbnail:{borderRadius:e.gridFileEntry.borderRadius,position:"absolute",zIndex:6,bottom:5,right:5,left:5,top:5}})),Wt=E(()=>({selectionIndicator:{display:e=>e.selected?"block":"none",background:"repeating-linear-gradient(45deg,rgba(0,153,255,.14),rgba(0,153,255,.14) 10px,rgba(0,153,255,.25) 0,rgba(0,153,255,.25) 20px)",backgroundColor:"rgba(0, 153, 255, .14)",position:"absolute",height:"100%",width:"100%",zIndex:10},focusIndicator:{display:e=>e.focused?"block":"none",boxShadow:"inset rgba(0, 0, 0, 1) 0 0 0 2px",position:"absolute",height:"100%",width:"100%",zIndex:11}}));var Ho=Ae.default.memo(({file:e,selected:t,focused:o,dndState:r})=>{let n=F.isDirectory(e),i=Le(e,t,o),l=Ki(i),s=Ne(e),a=H({[l.gridFileEntry]:!0});return Ae.default.createElement("div",{className:a,...s},n?Ae.default.createElement(zo,{className:l.gridFileEntryPreview,entryState:i,dndState:r}):Ae.default.createElement(Ro,{className:l.gridFileEntryPreview,entryState:i,dndState:r}),Ae.default.createElement("div",{className:l.gridFileEntryNameContainer},Ae.default.createElement(Ie,{className:l.gridFileEntryName,file:e})))});Ho.displayName="GridEntry";var Ki=E(e=>({gridFileEntry:{flexDirection:"column",display:"flex",height:"100%"},gridFileEntryPreview:{flexGrow:1},gridFileEntryNameContainer:{fontSize:e.gridFileEntry.fontSize,wordBreak:"break-word",textAlign:"center",paddingTop:5},gridFileEntryName:{backgroundColor:t=>t.selected?"rgba(0,153,255, .25)":"transparent",textDecoration:t=>t.focused?"underline":"none",borderRadius:3,padding:[2,4]}}));var v=u(require("react"));var Vi=e=>{let t=30;if(e){if(e.length<t)return e;let[o]=e.split(/\.(?=[^\.]+$)/);return o.slice(0,t)+"..."}else return""},Ln=Vi;var On=v.default.memo(({file:e,selected:t,focused:o,dndState:r,activeStar:n,deactivateStar:i,tags:l})=>{let s=Le(e,t,o),a=Oe(r),{fileModDateString:c,fileSizeString:d}=xt(e),p=(0,v.useMemo)(()=>({entryState:s,dndState:r}),[r,s]),b=_i(p),h=Wt(s),C=(0,v.useContext)(M),S=Ne(e);return v.default.createElement("div",{className:`${b.listFileEntry} ${e!=null&&e.isChecked?"is-checked":""}`,...S},v.default.createElement("div",{className:h.focusIndicator}),v.default.createElement("div",{className:H([h.selectionIndicator,b.listFileEntrySelection])}),v.default.createElement("div",{className:b.listFileEntryStar},e!=null&&e.isDir?null:v.default.createElement(v.default.Fragment,null,e!=null&&e.isStarred?n:i)),v.default.createElement("div",{className:b.listFileEntryIcon},v.default.createElement(C,{icon:a??s.icon,spin:a?!1:s.iconSpin,fixedWidth:!0,file:e})),v.default.createElement("div",{className:b.listFileEntryName,title:e?e.name:void 0},v.default.createElement(Ie,{file:e,tags:l})),(e==null?void 0:e.isSearchResults)&&(e==null?void 0:e.folderPath)?v.default.createElement("div",{className:b.listFileSearch},Ln(e==null?void 0:e.folderPath),v.default.createElement("span",{className:"list-file-search-tooltip"},e==null?void 0:e.folderPath)):null,v.default.createElement("div",{className:b.listFileEntryProperty},e?c??v.default.createElement("span",null,"\u2014"):v.default.createElement(Fe,{minLength:5,maxLength:15})),v.default.createElement("div",{className:b.listFileSizeProperty},e?d??v.default.createElement("span",null,"\u2014"):v.default.createElement(Fe,{minLength:10,maxLength:20})),v.default.createElement("div",{className:b.listFileShared},e!=null&&e.isShared?"Shared":"Private"))}),_i=E(e=>({listFileEntry:{boxShadow:`inset ${e.palette.divider} 0 -1px 0`,fontSize:e.listFileEntry.fontSize,color:({dndState:t})=>t.dndIsOver?t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:"inherit",alignItems:"center",position:"relative",display:"flex",height:"100%"},listFileEntrySelection:{opacity:.6},listFileEntryStar:{},listFileShared:{},listFileEntryIcon:{color:({entryState:t,dndState:o})=>o.dndIsOver?o.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:t.color,fontSize:e.listFileEntry.iconFontSize,boxSizing:"border-box",padding:[2,4],zIndex:20},listFileSearch:{},listFileEntryName:{textOverflow:"ellipsis",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",flex:"1 1 300px",paddingLeft:8,zIndex:20},listFileEntryProperty:{fontSize:e.listFileEntry.propertyFontSize,boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",flex:"0 1 150px",padding:[2,8],zIndex:20},listFileSizeProperty:{fontSize:e.listFileEntry.propertyFontSize,boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",flex:"0 1 150px",padding:[2,8],zIndex:20}}));var Wi={dndIsDragging:!1,dndIsOver:!1,dndCanDrop:!1},lt=me.default.memo(({fileId:e,displayIndex:t,fileViewMode:o,activeStar:r,deactivateStar:n,tags:i})=>{let l=$i(),s=_(oo,e),a=_(lo,e),c=(0,zn.useSelector)(je),d=an(s,t),[p,b]=(0,me.useState)(!1),h={wrapperTag:"div",passthroughProps:{className:l.fileEntryClickableWrapper},...F.isClickable(s)?d:void 0,setFocused:b},C={file:s,selected:a,focused:p,activeStar:r,deactivateStar:n,tags:i},S;return o==="list"?S=On:o==="compact"?S=En:S=Ho,c?me.default.createElement(No,{...h},me.default.createElement(S,{...C,dndState:Wi})):me.default.createElement(Tn,{file:s},w=>me.default.createElement(No,{...h},me.default.createElement(S,{...C,dndState:w})))});lt.displayName="SmartFileEntry";var $i=k(()=>({fileEntryClickableWrapper:{outline:"none !important",position:"relative",height:"100%"}}));var ji=()=>typeof window.orientation<"u"||navigator.userAgent.indexOf("IEMobile")!==-1,Rn=(e,t,o,r)=>{let n=r?5:8,i=ji()?0:18,l,s;return r?(l=2,s=(e-n-i)/l):(s=o.entryWidth,l=Math.max(1,Math.floor((e-i)/(s+n)))),{rowCount:Math.ceil(t/l),columnCount:l,gutter:n,rowHeight:o.entryHeight,columnWidth:s}},Bn=R.default.memo(e=>{let{width:t,height:o,fileListStyle:r={width:0,gridHeight:0}}=e,n=(0,$t.useSelector)(ce),i=(0,$t.useSelector)($.getDisplayFileIds),l=(0,R.useMemo)(()=>i.length,[i]),s=(0,R.useRef)(),a=kt(),[c,d]=(0,R.useState)(Rn(t,l,n,a)),p=(0,R.useRef)(c);(0,R.useEffect)(()=>{let x=p.current,T=Rn(t,l,n,a);p.current=T,s.current&&(x.rowCount!==T.rowCount&&s.current.resetAfterRowIndex(Math.min(x.rowCount,T.rowCount)-1),x.columnCount!==T.columnCount&&s.current.resetAfterColumnIndex(Math.min(x.columnCount,T.rowCount)-1),x.columnWidth!==T.columnWidth&&s.current.resetAfterIndices({columnIndex:0,rowIndex:0})),d(T)},[d,p,a,t,n,l]);let b=(0,R.useMemo)(()=>{let x=p;return{getColumnWidth:T=>r.width?r.width:x.current.columnWidth+(T===x.current.columnCount-1?0:x.current.gutter),getRowHeight:T=>r.gridHeight?r.gridHeight:x.current.rowHeight+(T===x.current.rowCount-1?0:x.current.gutter)}},[p]),h=ne((0,$t.useSelector)($.getDisplayFileIds)),C=(0,R.useCallback)(x=>{let T=x.rowIndex*p.current.columnCount+x.columnIndex;return h.current[T]??`loading-file-${T}`},[p,h]),S=(0,R.useCallback)(x=>{let T=p,qt=x.rowIndex*T.current.columnCount+x.columnIndex,Xn=i[qt];if(i[qt]===void 0)return null;let Zn={...x.style,paddingRight:x.columnIndex===T.current.columnCount-1?0:T.current.gutter,paddingBottom:x.rowIndex===T.current.rowCount-1?0:T.current.gutter,boxSizing:"border-box"};return R.default.createElement("div",{style:Zn},R.default.createElement(lt,{fileId:Xn??null,displayIndex:qt,fileViewMode:n.mode}))},[i,n.mode]),w=Ui();return(0,R.useMemo)(()=>R.default.createElement(Hn.VariableSizeGrid,{ref:s,className:w.gridContainer,estimatedRowHeight:c.rowHeight+c.gutter,rowHeight:b.getRowHeight,estimatedColumnWidth:c.columnWidth+c.gutter,columnWidth:b.getColumnWidth,columnCount:c.columnCount,height:o,rowCount:c.rowCount,width:t,itemKey:C},S),[w.gridContainer,c.rowHeight,c.gutter,c.columnWidth,c.columnCount,c.rowCount,b.getRowHeight,b.getColumnWidth,o,t,C,S])}),Ui=k(()=>({gridContainer:{}}));var oe=u(require("react")),Bo=require("react-redux"),Gn=require("react-window");var Kn=oe.default.memo(e=>{let{width:t,height:o,fileListStyle:r={height:0},activeStar:n,deactivateStar:i,tags:l}=e,s=(0,Bo.useSelector)(ce),a=(0,oe.useRef)(),c=(0,Bo.useSelector)($.getDisplayFileIds),d=ne(c),p=(0,oe.useCallback)(C=>d.current[C]??`loading-file-${C}`,[d]),b=qi();return(0,oe.useMemo)(()=>{let C=S=>oe.default.createElement("div",{style:{...S.style}},oe.default.createElement(lt,{fileId:c[S.index]??null,displayIndex:S.index,fileViewMode:"list",activeStar:n,deactivateStar:i,tags:l}));return oe.default.createElement(Gn.FixedSizeList,{ref:a,className:b.listContainer,itemSize:r.height||s.entryHeight,height:o,itemCount:c.length,width:t,itemKey:p},C)},[b.listContainer,s.entryHeight,o,c,t,p])}),qi=E(e=>({listContainer:{borderTop:`solid 1px ${e.palette.divider}`}}));var st=V.default.memo(e=>{let t=(0,jt.useSelector)($.getDisplayFileIds),o=(0,jt.useSelector)(ce),r=(0,jt.useSelector)(ve),{drop:n,dndCanDrop:i,dndIsOverCurrent:l}=tt({file:r}),s=(0,V.useMemo)(()=>({dndCanDrop:i,dndIsOverCurrent:l}),[i,l]),a=Yi(s),c=Xi(o),{onScroll:d,fileListStyle:p,activeStar:b,deactivateStar:h,tags:C}=e,S=!0,w=(0,V.useCallback)(({width:x,height:T})=>t.length===0?V.default.createElement(An,{width:x,height:o.entryHeight}):o.mode==="list"?V.default.createElement(Kn,{width:x,height:T,fileListStyle:p,activeStar:b,deactivateStar:h,tags:C}):V.default.createElement(Bn,{width:x,height:T,fileListStyle:p}),[t,o]),N=(0,V.useContext)(M);return V.default.createElement("div",{onScroll:d,ref:n,className:H([c.fileListWrapper,a.fileListWrapper]),role:"list"},V.default.createElement("div",{className:a.dndDropZone},V.default.createElement("div",{className:a.dndDropZoneIcon},V.default.createElement(N,{icon:i?"dndCanDrop":"dndCannotDrop"}))),V.default.createElement(Vn.default,{disableHeight:!S},w))});st.displayName="FileList";var Yi=E(e=>({fileListWrapper:{minHeight:f.EnableGridView.fileViewConfig.entryHeight+2,background:t=>t.dndIsOverCurrent&&t.dndCanDrop?t.dndCanDrop?vo(e.dnd.fileListCanDropMaskOne,e.dnd.fileListCanDropMaskTwo):vo(e.dnd.fileListCannotDropMaskOne,e.dnd.fileListCannotDropMaskTwo):"none"},dndDropZone:{display:t=>t.dndIsOverCurrent&&t.dndCanDrop?"block":"none",borderRadius:e.gridFileEntry.borderRadius,pointerEvents:"none",position:"absolute",height:"100%",width:"100%",zIndex:2},dndDropZoneIcon:{backgroundColor:t=>t.dndCanDrop?e.dnd.canDropMask:e.dnd.cannotDropMask,color:t=>t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor,borderRadius:e.gridFileEntry.borderRadius,transform:"translateX(-50%) translateY(-50%)",position:"absolute",textAlign:"center",lineHeight:"60px",fontSize:"2em",left:"50%",height:60,top:"50%",width:60}})),Xi=k(()=>({fileListWrapper:{height:"100%",maxHeight:"100%"}}));var J=u(require("react")),_n=require("react-intl"),at=require("react-redux"),Wn=u(require("@material-ui/core/ListSubheader")),$n=u(require("@material-ui/core/Menu"));var Ut=J.default.memo(()=>{let e=(0,at.useDispatch)();(0,J.useEffect)(()=>(e(g.setContextMenuMounted(!0)),()=>{e(g.setContextMenuMounted(!1))}),[e]);let o=(0,_n.useIntl)().formatMessage({id:q("contextMenu","browserMenuShortcut"),defaultMessage:"Browser menu: {shortcut}"},{shortcut:J.default.createElement("strong",null,"Alt + Right Click")}),r=(0,at.useSelector)(ut),n=(0,at.useSelector)(eo),i=Kr(),l=(0,J.useMemo)(()=>{let c=[];for(let d=0;d<n.length;++d){let p=n[d];typeof p=="string"?c.push(J.default.createElement(rt,{key:`context-menu-item-${p}`,fileActionId:p,onClickFollowUp:i})):p.fileActionIds.map(b=>c.push(J.default.createElement(rt,{key:`context-menu-item-${p.name}-${b}`,fileActionId:b,onClickFollowUp:i})))}return c},[n,i]),s=(0,J.useMemo)(()=>r?{top:r.mouseY,left:r.mouseX}:void 0,[r]),a=Zi();return J.default.createElement($n.default,{elevation:2,disablePortal:!0,onClose:i,transitionDuration:150,open:!!r,anchorPosition:s,anchorReference:"anchorPosition",classes:{list:a.contextMenuList}},l,J.default.createElement(Wn.default,{component:"div",className:a.browserMenuTooltip},o))}),Zi=k(()=>({contextMenuList:{paddingBottom:y(0),paddingTop:y(0)},browserMenuTooltip:{lineHeight:y("30px"),fontSize:y("0.7em")}}));var U=u(require("react"));var Go=U.default.memo(U.default.forwardRef((e,t)=>{let{onScroll:o,fileListStyle:r,activeStar:n=U.default.createElement(U.default.Fragment,null),deactivateStar:i=U.default.createElement(U.default.Fragment,null),tags:l=U.default.createElement(U.default.Fragment,null)}=e;return U.default.createElement(et,{ref:t,...e},U.default.createElement(Ht,null),U.default.createElement(Kt,null),U.default.createElement(st,{onScroll:o,fileListStyle:r,activeStar:n,deactivateStar:i,tags:l}),U.default.createElement(Ut,null))}));Go.displayName="FullFileBrowser";var Ko={};Vo(Ko,{useFileActionHandler:()=>Yn,useFileMap:()=>Qi,useFileMapMethods:()=>qn,useFiles:()=>Un,useFolderChain:()=>jn});var re=require("react");var jn=(e,t)=>(0,re.useMemo)(()=>{let o=e[t],r=[o],n=o.parentId;for(;n;){let i=e[n];if(i)r.unshift(i),n=i.parentId;else break}return r},[t,e]),Un=(e,t)=>(0,re.useMemo)(()=>e[t].childrenIds.map(i=>e[i]),[t,e]),qn=(e,t)=>{let[o,r]=(0,re.useState)(e),[n,i]=(0,re.useState)(t),l=(0,re.useCallback)(()=>{r(e),i(t)},[e,t]),s=(0,re.useCallback)((c,d,p)=>r(b=>{let h={...b},C=new Set(c.map(N=>N.id)),S=d.childrenIds.filter(N=>!C.has(N));h[d.id]={...d,childrenIds:S,childrenCount:S.length};let w=[...p.childrenIds,...c.map(N=>N.id)];return h[p.id]={...p,childrenIds:w,childrenCount:w.length},c.forEach(N=>{h[N.id]={...N,parentId:p.id}}),h}),[]),a=(0,re.useMemo)(()=>({setFileMap:r,setCurrentFolderId:i,resetFileMap:l,moveFiles:s}),[r,i,l,s]);return{fileMap:o,currentFolderId:n,methods:a}},Yn=e=>(0,re.useCallback)(t=>{if(t.id===f.OpenFiles.id){let{targetFile:o,files:r}=t.payload,n=o??r[0];n&&F.isDirectory(n)&&e.setCurrentFolderId(n.id)}else t.id===f.MoveFiles.id&&e.moveFiles(t.payload.files,t.payload.source,t.payload.destination)},[e]),Qi=({baseFileMap:e,initialFolderId:t})=>{let{fileMap:o,currentFolderId:r,methods:n}=qn(e,t),i=jn(o,r),l=Un(o,r),s=Yn(n);return{data:{fileMap:o,currentFolderId:r,folderChain:i,files:l},methods:n,fileActionHandler:s}};0&&(module.exports={ChonkyActions,ChonkyDndFileEntryType,ChonkyIconName,CustomVisibilityState,DefaultFileActions,FileBrowser,FileContextMenu,FileHelper,FileList,FileNavbar,FileToolbar,FileViewMode,FullFileBrowser,I18nNamespace,OptionIds,defaultFormatters,defineFileAction,fileMap,getActionI18nId,getFileData,getI18nId,getIsFileSelected,getSelectedFiles,getSelectedFilesForAction,reduxActions,rootReducer,selectCleanFileIds,selectClearSelectionOnOutsideClick,selectContextMenuConfig,selectContextMenuItems,selectContextMenuMounted,selectContextMenuTriggerFile,selectCurrentFolder,selectDisableSelection,selectDoubleClickDelay,selectExternalFileActionHandler,selectFileActionData,selectFileActionIds,selectFileActionMap,selectFileData,selectFileMap,selectFileViewConfig,selectFocusSearchInput,selectFolderChain,selectHiddenFileCount,selectHiddenFileIdMap,selectInstanceId,selectIsDnDDisabled,selectIsFileSelected,selectOptionMap,selectOptionValue,selectParentFolder,selectRawFiles,selectSearchString,selectSelectedFileIds,selectSelectedFiles,selectSelectedFilesForAction,selectSelectedFilesForActionCount,selectSelectionMap,selectSelectionSize,selectSortActionId,selectSortOrder,selectThumbnailGenerator,selectToolbarItems,selectors,setChonkyDefaults,thunkDispatchFileAction,thunkRequestFileAction,useChonkyStore,useDTE,useParamSelector,usePropReduxUpdate});
/**
 * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>
 * @copyright 2019
 * @license MIT
 */
/**
 * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>
 * @copyright 2020
 * @license MIT
 */
//# sourceMappingURL=index.cjs.js.map